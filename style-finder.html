<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Style Finder | Society Arts</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://pub-acb560f551f141db830964aed1fa005f.r2.dev/site-assets/SA_Monogram_Black%401x%201x1.png">
    
    <!-- Fonts - Familjen Grotesk + Domine -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Domine:wght@400;500;600;700&family=Familjen+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/modals.css">
    <link rel="stylesheet" href="css/auth.css">
    
    <!-- Supabase Client Library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        /* ========================================
           STYLE FINDER - A++ BRAND STYLES
           ======================================== */
        
        /* Variables for sidebar */
        :root {
            --sidebar-width-collapsed: 50px;
            --sidebar-width-expanded: 220px;
            --sidebar-transition: 0.2s ease;
            --header-height: 56px;
        }
        
        /* Sidebar and header styles are provided by /css/header.css */
        /* No local overrides needed - using unified header/sidebar system */
        
        /* Header styles are provided by /css/header.css */
        /* Just override specific styles for Style Finder page layout */
        
        /* Style Finder Page Layout */
        .style-finder-page {
            display: flex;
            min-height: 100vh;
            padding-top: var(--header-height);
            padding-left: var(--sidebar-width-collapsed);
            background: var(--color-beige, #EAE4DA);
            transition: padding-left var(--sidebar-transition);
        }
        
        /* Filter Sidebar */
        .filter-sidebar {
            width: 240px;
            background: var(--color-surface, #F9F8F6);
            border-right: 1px solid var(--color-tan-20, #E7E2DC);
            overflow-y: auto;
            padding: 20px 16px;
            flex-shrink: 0;
            height: calc(100vh - var(--header-height));
            position: sticky;
            top: var(--header-height);
        }
        
        /* Filter Section Labels - A++ Typography */
        .filter-section {
            margin-bottom: 24px;
        }
        
        .filter-section h3 {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 12px;
            font-weight: 600;
            color: var(--color-brown-60, #8B7B75);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 10px;
        }
        
        .filter-select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--color-tan-20, #E7E2DC);
            border-radius: 8px;
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 14px;
            color: var(--color-brown, #3E2318);
            background: white;
            cursor: pointer;
            transition: border-color 0.15s ease;
        }
        
        .filter-select:focus {
            outline: none;
            border-color: var(--color-tan-40, #CFC5B9);
        }
        
        .filter-select:hover {
            border-color: var(--color-tan-40, #CFC5B9);
        }
        
        /* Reset/Apply Buttons - A++ Brand */
        .filter-actions {
            position: sticky;
            bottom: 0;
            background: var(--color-surface, #F9F8F6);
            padding: 16px 0;
            border-top: 1px solid var(--color-tan-20, #E7E2DC);
            display: flex;
            gap: 8px;
            margin-top: 16px;
        }
        
        .filter-actions .reset-btn {
            flex: 1;
            padding: 10px 16px;
            background: transparent;
            border: 1.5px solid var(--color-brown, #3E2318);
            border-radius: 9999px;
            cursor: pointer;
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--color-brown, #3E2318);
            transition: all 0.15s ease;
        }
        
        .filter-actions .reset-btn:hover {
            background: var(--color-tan-10, #F3F1EE);
        }
        
        /* Apply Button - PRIMARY BROWN (not orange!) */
        .filter-actions .apply-btn {
            flex: 1;
            padding: 10px 16px;
            background: var(--color-brown, #3E2318);
            border: none;
            border-radius: 9999px;
            cursor: pointer;
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: white;
            transition: all 0.15s ease;
        }
        
        .filter-actions .apply-btn:hover {
            background: rgba(62, 35, 24, 0.85);
        }
        
        /* Main Content - A++ Brand */
        .styles-main {
            flex: 1;
            overflow-y: auto;
            background: var(--color-beige, #EAE4DA);
            display: flex;
            flex-direction: column;
        }
        
        /* Sticky Search Header */
        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: var(--color-beige, #EAE4DA);
            padding: 16px 24px;
            border-bottom: 1px solid var(--color-tan-20, #E7E2DC);
        }
        
        /* Search Bar */
        .search-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            align-items: center;
        }
        
        .search-input-wrapper {
            flex: 1;
            min-width: 200px;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 16px;
            padding-right: 80px;
            border: 1px solid var(--color-tan-20, #E7E2DC);
            border-radius: 9999px;
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 14px;
            color: var(--color-brown, #3E2318);
            background: white;
            transition: all 0.15s ease;
        }
        
        /* Advanced Search Button */
        .advanced-search-btn {
            position: absolute;
            right: 40px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: var(--color-brown-60, #8B7B75);
            padding: 6px;
            border-radius: 6px;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s ease;
        }
        
        .advanced-search-btn:hover {
            background: var(--color-tan-20, #E7E2DC);
            color: var(--color-brown, #3E2318);
        }
        
        .advanced-search-btn.active {
            background: var(--color-orange-dark, #C73314);
            color: white;
        }
        
        /* Advanced Search Dropdown */
        .advanced-search-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            width: 320px;
            background: white;
            border: 1px solid var(--color-tan-20, #E7E2DC);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(62, 35, 24, 0.15);
            z-index: 100;
            display: none;
            padding: 16px;
        }
        
        .advanced-search-dropdown.open {
            display: block;
        }
        
        .advanced-search-dropdown h4 {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--color-brown, #3E2318);
            margin: 0 0 12px 0;
        }
        
        .search-filter-group {
            margin-bottom: 12px;
        }
        
        .search-filter-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 13px;
            color: var(--color-brown, #3E2318);
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: background 0.15s ease;
        }
        
        .search-filter-label:hover {
            background: var(--color-tan-10, #F3F1EE);
        }
        
        .search-filter-label input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: var(--color-orange-dark, #C73314);
        }
        
        .search-filter-label input[type="radio"] {
            width: 16px;
            height: 16px;
            accent-color: var(--color-orange-dark, #C73314);
        }
        
        .search-apply-btn {
            width: 100%;
            padding: 10px 16px;
            background: var(--color-brown, #3E2318);
            color: white;
            border: none;
            border-radius: 8px;
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 8px;
            transition: background 0.15s ease;
        }
        
        .search-apply-btn:hover {
            background: var(--color-brown-80, #5C4336);
        }
        
        .search-input::placeholder {
            color: var(--color-brown-40, #B2A7A3);
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--color-tan-40, #CFC5B9);
            box-shadow: 0 0 0 3px rgba(62, 35, 24, 0.08);
        }
        
        .search-clear-btn {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: var(--color-brown-60, #8B7B75);
            padding: 4px;
            display: none;
            border-radius: 50%;
            line-height: 1;
        }
        
        .search-clear-btn:hover {
            background: var(--color-tan-20, #E7E2DC);
            color: var(--color-brown, #3E2318);
        }
        
        .search-clear-btn.visible {
            display: block;
        }
        
        /* Active Filter Pills - A++ Brand */
        .filter-pills {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }
        
        .filter-pills:empty {
            display: none;
        }
        
        .filter-pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: var(--color-brown, #3E2318);
            color: white;
            border-radius: 9999px;
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 13px;
            font-weight: 500;
        }
        
        .filter-pill-remove {
            background: none;
            border: none;
            color: rgba(255,255,255,0.7);
            cursor: pointer;
            padding: 0;
            line-height: 1;
            font-size: 14px;
        }
        
        .filter-pill-remove:hover {
            color: white;
        }
        
        .reset-all-btn {
            padding: 6px 12px;
            background: transparent;
            border: 1.5px solid var(--color-brown, #3E2318);
            border-radius: 9999px;
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 13px;
            font-weight: 600;
            color: var(--color-brown, #3E2318);
            cursor: pointer;
            transition: all 0.15s ease;
        }
        
        .reset-all-btn:hover {
            background: var(--color-tan-10, #F3F1EE);
        }
        
        /* Search Hint & Results */
        .search-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 8px;
        }
        
        .search-hint {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 12px;
            color: var(--color-brown-60, #8B7B75);
        }
        
        .results-count {
            font-family: 'Familjen Grotesk', sans-serif;
            color: var(--color-brown-60, #8B7B75);
            font-size: 14px;
            white-space: nowrap;
        }
        
        /* Scrollable content area */
        .styles-content {
            flex: 1;
            padding: 24px;
        }
        
        /* Sort Dropdown - A++ Brand */
        .sort-container {
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }
        
        .sort-container label {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 14px;
            color: var(--color-brown-60, #8B7B75);
        }
        
        .sort-select {
            padding: 8px 12px;
            border: 1px solid var(--color-tan-20, #E7E2DC);
            border-radius: 8px;
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 14px;
            color: var(--color-brown, #3E2318);
            background: white;
            cursor: pointer;
            min-width: 150px;
            transition: border-color 0.15s ease;
        }
        
        .sort-select:focus {
            outline: none;
            border-color: var(--color-tan-40, #CFC5B9);
        }
        
        /* Quality Filter - A++ Brand */
        .quality-filter-container {
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }
        
        .quality-filter-container label {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 14px;
            color: var(--color-brown-60, #8B7B75);
        }
        
        .quality-filter-select {
            padding: 8px 12px;
            border: 1px solid var(--color-tan-20, #E7E2DC);
            border-radius: 8px;
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 14px;
            color: var(--color-brown, #3E2318);
            background: white;
            cursor: pointer;
            min-width: 130px;
            transition: border-color 0.15s ease;
        }
        
        .quality-filter-select:focus {
            outline: none;
            border-color: var(--color-tan-40, #CFC5B9);
        }
        
        /* Style Grid - A++ Brand - 6 columns on large screens */
        .styles-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 16px;
        }
        
        @media (max-width: 1600px) {
            .styles-grid {
                grid-template-columns: repeat(5, 1fr);
            }
        }
        
        @media (max-width: 1200px) {
            .styles-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        @media (max-width: 900px) {
            .styles-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 600px) {
            .styles-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .style-card {
            background: var(--color-tan-5, #F9F8F6);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(62, 35, 24, 0.08);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
            position: relative;
        }
        
        .style-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(62, 35, 24, 0.12);
        }
        
        /* Multi-select mode */
        .style-card.selected {
            outline: 3px solid var(--color-orange-dark, #C73314);
            outline-offset: -3px;
        }
        
        .style-card .select-checkbox {
            position: absolute;
            top: 8px;
            left: 8px;
            width: 24px;
            height: 24px;
            border-radius: 6px;
            background: rgba(255,255,255,0.9);
            border: 2px solid var(--color-brown-60, #8B7B75);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3;
            opacity: 0;
            transition: opacity 0.2s ease, background 0.15s ease, border-color 0.15s ease;
        }
        
        .style-card:hover .select-checkbox,
        .style-card.selected .select-checkbox,
        .multi-select-active .style-card .select-checkbox {
            opacity: 1;
        }
        
        .style-card.selected .select-checkbox {
            background: var(--color-orange-dark, #C73314);
            border-color: var(--color-orange-dark, #C73314);
        }
        
        .style-card.selected .select-checkbox svg {
            color: white;
        }
        
        .style-card-image {
            aspect-ratio: 1;
            background: var(--color-tan-10, #F3F1EE);
            position: relative;
            overflow: hidden;
        }
        
        .style-card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .style-card-image .placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-brown-60, #8B7B75);
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 12px;
        }
        
        .favorite-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255,255,255,0.9);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s ease;
            z-index: 2;
            color: var(--color-brown-60, #8B7B75);
        }
        
        .favorite-btn:hover {
            transform: scale(1.1);
            color: var(--color-orange-dark, #C73314);
        }
        
        .favorite-btn.active {
            color: var(--color-orange-dark, #C73314);
        }
        
        .favorite-btn.active svg {
            fill: var(--color-orange-dark, #C73314);
        }
        
        /* Three-dot menu - bottom right of image, show on hover */
        .menu-btn-horizontal {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(255,255,255,0.9);
            border: none;
            cursor: pointer;
            padding: 6px 8px;
            border-radius: 6px;
            display: flex;
            gap: 3px;
            opacity: 0;
            transition: opacity 0.2s ease;
            z-index: 2;
        }
        
        .style-card:hover .menu-btn-horizontal {
            opacity: 1;
        }
        
        .menu-btn-horizontal .dot {
            width: 4px;
            height: 4px;
            background: var(--color-brown-60, #8B7B75);
            border-radius: 50%;
        }
        
        .menu-btn-horizontal:hover {
            background: white;
        }
        
        .menu-btn-horizontal:hover .dot {
            background: var(--color-brown, #3E2318);
        }
        
        /* Card info - Hidden by default, title shows in menu */
        .style-card-info {
            display: none;
        }
        
        /* Card Title - A++ Typography: Familjen Grotesk SemiBold 17px */
        .style-card-name {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 17px;
            font-weight: 600;
            color: var(--color-brown, #3E2318);
            margin: 0;
            line-height: 1.3;
        }
        
        .style-card-tagline {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 13px;
            color: var(--color-brown-60, #8B7B75);
            margin-top: 4px;
        }
        
        /* Multi-select action bar */
        .multi-select-bar {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--color-brown, #3E2318);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 16px;
            box-shadow: 0 8px 32px rgba(62, 35, 24, 0.3);
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s ease, visibility 0.2s ease;
        }
        
        .multi-select-bar.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .multi-select-count {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 14px;
            font-weight: 600;
        }
        
        .multi-select-bar button {
            background: rgba(255,255,255,0.15);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: background 0.15s ease;
        }
        
        .multi-select-bar button:hover {
            background: rgba(255,255,255,0.25);
        }
        
        .multi-select-bar button.cancel-btn {
            background: transparent;
            opacity: 0.7;
        }
        
        .multi-select-bar button.cancel-btn:hover {
            opacity: 1;
            background: transparent;
        }
        
        .multi-select-bar button.danger-btn {
            background: #dc3545;
            border-color: #dc3545;
        }
        
        .multi-select-bar button.danger-btn:hover {
            background: #c82333;
            border-color: #bd2130;
        }
        
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-top: 2rem;
            padding: 1rem;
        }
        
        .pagination-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--color-border, #ddd);
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .pagination-btn:hover:not(:disabled) {
            background: var(--color-accent, #C75B3F);
            color: white;
            border-color: var(--color-accent, #C75B3F);
        }
        
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .pagination-info {
            color: var(--color-text-secondary, #666);
            font-size: 0.875rem;
        }
        
        /* Loading State */
        .loading-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(255,255,255,0.8);
            z-index: 100;
            align-items: center;
            justify-content: center;
        }
        
        .loading-overlay.active {
            display: flex;
        }
        
        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 4px solid var(--color-border, #ddd);
            border-top-color: var(--color-accent, #C75B3F);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Style Detail Modal */
        .style-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }
        
        .style-modal.active {
            display: flex;
        }
        
        .style-modal-content {
            background: white;
            border-radius: 16px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        
        .style-modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 40px;
            height: 40px;
            border: none;
            background: var(--color-surface, #f5f5f5);
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        
        .style-modal-gallery {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 0.5rem;
            padding: 1.5rem;
            background: var(--color-surface, #f5f5f5);
        }
        
        .style-modal-gallery img {
            width: 100%;
            aspect-ratio: 1;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .style-modal-gallery img:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .style-modal-info {
            padding: 1.5rem;
        }
        
        .style-modal-title-row {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            margin-bottom: 0.25rem;
        }
        
        .style-modal-name {
            font-family: 'Domine', serif;
            font-size: 1.75rem;
            font-weight: 600;
            margin: 0;
            color: var(--color-brown, #3E2318);
            flex: 1;
        }
        
        .style-modal-name-input {
            font-family: 'Domine', serif;
            font-size: 1.75rem;
            font-weight: 600;
            color: var(--color-brown, #3E2318);
            border: 2px solid var(--color-tan-40, #CFC5B9);
            border-radius: 8px;
            padding: 0.25rem 0.5rem;
            width: 100%;
            margin-bottom: 0.5rem;
        }
        
        .style-modal-name-input:focus {
            outline: none;
            border-color: var(--color-accent, #C73314);
        }
        
        .style-modal-edit-btn {
            background: none;
            border: none;
            padding: 6px;
            cursor: pointer;
            color: var(--color-brown-60, #8B7B75);
            border-radius: 4px;
            transition: all 0.15s ease;
            flex-shrink: 0;
        }
        
        .style-modal-edit-btn:hover {
            background: var(--color-tan-20, #E7E2DC);
            color: var(--color-brown, #3E2318);
        }
        
        .style-modal-tagline {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 1rem;
            color: var(--color-accent, #C73314);
            margin-bottom: 1rem;
            font-style: italic;
        }
        
        .style-modal-description-row {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .style-modal-description {
            font-family: 'Familjen Grotesk', sans-serif;
            color: var(--color-brown-60, #8B7B75);
            line-height: 1.6;
            margin: 0;
            flex: 1;
        }
        
        .style-modal-desc-input {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 0.95rem;
            color: var(--color-brown, #3E2318);
            border: 2px solid var(--color-tan-40, #CFC5B9);
            border-radius: 8px;
            padding: 0.5rem;
            width: 100%;
            margin-bottom: 1rem;
            resize: vertical;
            line-height: 1.6;
        }
        
        .style-modal-desc-input:focus {
            outline: none;
            border-color: var(--color-accent, #C73314);
        }
        
        .style-modal-id {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 12px;
            font-weight: 600;
            color: var(--color-brown-60, #8B7B75);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 1rem;
        }
        
        .style-modal-tags-section {
            margin-bottom: 1.5rem;
        }
        
        .style-modal-tags-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        .style-modal-section-label {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 11px;
            font-weight: 600;
            color: var(--color-brown-60, #8B7B75);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .style-modal-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .style-tag {
            background: var(--color-surface, #f5f5f5);
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            font-size: 0.8rem;
            color: var(--color-text-secondary, #666);
        }
        
        .style-modal-attributes {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }
        
        .attribute-item {
            background: var(--color-surface, #f5f5f5);
            padding: 0.75rem 1rem;
            border-radius: 8px;
        }
        
        .attribute-label {
            font-size: 0.75rem;
            color: var(--color-text-secondary, #999);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .attribute-value {
            font-weight: 500;
            color: var(--color-text, #333);
        }
        
        /* Admin Edit Button in Style Modal */
        .style-modal-info .admin-edit-btn {
            margin-top: 1.5rem;
        }
        
        /* Style Modal Actions */
        .style-modal-actions {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .style-modal-action-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.625rem 1.25rem;
            border-radius: 25px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid var(--color-border, #e5e5e5);
            background: white;
        }
        
        .style-modal-action-btn:hover {
            background: var(--color-surface-alt, #f5f5f5);
        }
        
        .style-modal-action-btn.favorite {
            color: #dc2626;
        }
        
        .style-modal-action-btn.favorite.active {
            background: #fee2e2;
            border-color: #fca5a5;
        }
        
        .style-modal-action-btn.primary {
            background: var(--color-text-primary, #3D3530);
            color: white;
            border-color: var(--color-text-primary, #3D3530);
        }
        
        .style-modal-action-btn.primary:hover {
            opacity: 0.9;
        }
        
        .style-modal-admin-actions {
            display: flex;
            gap: 0.75rem;
            margin-top: 0.75rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .style-modal-action-btn.admin {
            font-size: 0.8rem;
            padding: 0.5rem 1rem;
            color: var(--color-brown-60, #8B7B75);
            border-color: var(--color-tan-40, #CFC5B9);
        }
        
        .style-modal-action-btn.admin:hover {
            background: var(--color-tan-10, #F3F1EE);
            color: var(--color-brown, #3E2318);
        }
        
        .style-modal-action-btn.admin.danger {
            color: #dc2626;
            border-color: #fca5a5;
        }
        
        .style-modal-action-btn.admin.danger:hover {
            background: #fee2e2;
        }
        
        /* Lightbox for zoomed images */
        .lightbox {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.95);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            cursor: zoom-out;
        }
        
        .lightbox.active {
            display: flex;
        }
        
        .lightbox-content {
            position: relative;
            max-width: 95vw;
            max-height: 95vh;
        }
        
        .lightbox-image {
            max-width: 95vw;
            max-height: 95vh;
            object-fit: contain;
            border-radius: 8px;
            cursor: default;
        }
        
        .lightbox-close {
            position: absolute;
            top: -40px;
            right: 0;
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            padding: 0.5rem;
        }
        
        .lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            font-size: 2rem;
            padding: 1rem;
            cursor: pointer;
            border-radius: 8px;
            transition: background 0.2s;
        }
        
        .lightbox-nav:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .lightbox-prev {
            left: 1rem;
        }
        
        .lightbox-next {
            right: 1rem;
        }
        
        .lightbox-counter {
            position: absolute;
            bottom: -40px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 0.875rem;
        }
        
        .lightbox-zoom-hint {
            position: absolute;
            bottom: -40px;
            right: 0;
            color: rgba(255,255,255,0.7);
            font-size: 0.75rem;
        }
        
        /* Zoomed state */
        .lightbox-image.zoomed {
            max-width: none;
            max-height: none;
            cursor: grab;
        }
        
        .lightbox-image.zoomed.dragging {
            cursor: grabbing;
        }
        
        /* Context Menu / Dropdown */
        .context-menu {
            display: none;
            position: fixed;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.15);
            min-width: 200px;
            z-index: 3000;
            overflow: hidden;
        }
        
        .context-menu.active {
            display: block;
        }
        
        .context-menu-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.875rem 1rem;
            cursor: pointer;
            transition: background 0.2s;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-size: 0.9375rem;
            color: var(--color-text, #333);
        }
        
        .context-menu-item:hover {
            background: var(--color-surface, #f5f5f5);
        }
        
        .context-menu-item svg {
            width: 20px;
            height: 20px;
            color: var(--color-text-secondary, #666);
        }
        
        .context-menu-divider {
            height: 1px;
            background: var(--color-border, #e5e5e5);
            margin: 0.25rem 0;
        }
        
        .context-menu-item.danger {
            color: #dc3545;
        }
        
        .context-menu-item.danger svg {
            color: #dc3545;
        }
        
        /* Context Menu Header (shows style name) */
        .context-menu-header {
            padding: 12px 16px;
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--color-brown, #3E2318);
            border-bottom: 1px solid var(--color-tan-20, #E7E2DC);
            background: var(--color-tan-5, #F9F8F6);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 250px;
        }
        
        /* Collection Modal */
        .collection-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 3000;
            align-items: center;
            justify-content: center;
        }
        
        .collection-modal.active {
            display: flex;
        }
        
        .collection-modal-content {
            background: white;
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            max-height: 70vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .collection-modal-header {
            padding: 1.25rem;
            border-bottom: 1px solid var(--color-border, #e5e5e5);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .collection-modal-header h3 {
            margin: 0;
            font-size: 1.125rem;
        }
        
        .collection-modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--color-text-secondary, #666);
        }
        
        .collection-modal-body {
            padding: 1rem;
            overflow-y: auto;
            flex: 1;
        }
        
        .collection-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .collection-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border: 1px solid var(--color-border, #ddd);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .collection-item:hover {
            border-color: var(--color-accent, #C75B3F);
            background: rgba(199, 91, 63, 0.05);
        }
        
        .collection-item.selected {
            border-color: var(--color-accent, #C75B3F);
            background: rgba(199, 91, 63, 0.1);
        }
        
        .collection-item-icon {
            width: 40px;
            height: 40px;
            background: var(--color-surface, #f5f5f5);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .collection-item-info {
            flex: 1;
        }
        
        .collection-item-name {
            font-weight: 500;
        }
        
        .collection-item-count {
            font-size: 0.75rem;
            color: var(--color-text-secondary, #999);
        }
        
        .create-collection-form {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--color-border, #e5e5e5);
        }
        
        .create-collection-input {
            flex: 1;
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--color-border, #ddd);
            border-radius: 6px;
            font-size: 0.875rem;
        }
        
        .create-collection-btn {
            padding: 0.5rem 1rem;
            background: var(--color-accent, #C75B3F);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            white-space: nowrap;
        }
        
        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: #333;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            z-index: 4000;
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .toast.active {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }
        
        /* Confirmation Modal */
        .confirm-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            z-index: 4000;
            align-items: center;
            justify-content: center;
        }
        
        .confirm-modal.active {
            display: flex;
        }
        
        .confirm-modal-content {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        
        .confirm-modal-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .confirm-modal-title {
            margin: 0 0 0.5rem;
            font-size: 1.25rem;
        }
        
        .confirm-modal-text {
            color: var(--color-text-secondary, #666);
            margin-bottom: 1.5rem;
            font-size: 0.9375rem;
        }
        
        .confirm-modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }
        
        .confirm-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 0.9375rem;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }
        
        .confirm-btn-cancel {
            background: var(--color-surface, #f5f5f5);
            color: var(--color-text, #333);
        }
        
        .confirm-btn-cancel:hover {
            background: var(--color-border, #e5e5e5);
        }
        
        .confirm-btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .confirm-btn-danger:hover {
            background: #c82333;
        }
        
        /* Responsive - Small screens */
        @media (max-width: 768px) {
            .filter-sidebar {
                display: none;
            }
            
            .style-modal-gallery {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .lightbox-nav {
                padding: 0.5rem;
                font-size: 1.5rem;
            }
        }
        
        /* Help Modal */
        .help-modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(62, 35, 24, 0.3);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .help-modal-overlay.open {
            display: flex;
        }
        
        .help-modal {
            background: white;
            border-radius: 16px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 20px 40px rgba(62, 35, 24, 0.2);
            overflow: hidden;
        }
        
        .help-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px;
            border-bottom: 1px solid var(--color-tan-20, #E7E2DC);
        }
        
        .help-modal-header h3 {
            font-family: 'Domine', serif;
            font-size: 20px;
            font-weight: 600;
            color: var(--color-brown, #3E2318);
            margin: 0;
        }
        
        .help-modal-close {
            width: 36px;
            height: 36px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-brown-60, #8B7B75);
            transition: all 0.15s ease;
        }
        
        .help-modal-close:hover {
            background: var(--color-tan-10, #F3F1EE);
            color: var(--color-brown, #3E2318);
        }
        
        .help-modal-content {
            padding: 12px;
        }
        
        .help-modal-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            border-radius: 12px;
            text-decoration: none;
            color: inherit;
            transition: background 0.15s ease;
        }
        
        .help-modal-item:hover {
            background: var(--color-tan-10, #F3F1EE);
        }
        
        .help-modal-item-icon {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            background: var(--color-tan-10, #F3F1EE);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--color-brown, #3E2318);
            flex-shrink: 0;
        }
        
        .help-modal-item-text {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .help-modal-item-title {
            font-family: 'Familjen Grotesk', sans-serif;
            font-size: 15px;
            font-weight: 600;
            color: var(--color-brown, #3E2318);
        }
        
        .help-modal-item-desc {
            font-size: 13px;
            color: var(--color-brown-60, #8B7B75);
        }
    </style>
</head>
<body>
    <!-- Sidebar and Header are injected by /js/shared/header.js -->
    <aside class="sidebar" id="sa-sidebar"></aside>
    <header class="header" id="sa-header"></header>
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
    </div>
    
    <!-- Main Content -->
    <div class="style-finder-page">
        <!-- Filter Sidebar -->
        <aside class="filter-sidebar">
            <div id="activeFiltersDisplay" class="active-filters" style="display:none;"></div>
            
            <div class="filter-section">
                <h3>Search</h3>
                <input type="text" class="filter-select" id="sidebarSearch" placeholder="Search styles...">
            </div>
            
            <div class="filter-section">
                <h3>Art Type</h3>
                <select class="filter-select" id="filterArtType">
                    <option value="">All Art Types</option>
                </select>
            </div>
            
            <div class="filter-section">
                <h3>Medium</h3>
                <select class="filter-select" id="filterMedium">
                    <option value="">All Mediums</option>
                </select>
            </div>
            
            <div class="filter-section">
                <h3>Culture</h3>
                <select class="filter-select" id="filterCulture">
                    <option value="">All Cultures</option>
                </select>
            </div>
            
            <div class="filter-section">
                <h3>Era</h3>
                <select class="filter-select" id="filterEra">
                    <option value="">All Eras</option>
                </select>
            </div>
            
            <div class="filter-section">
                <h3>Palette</h3>
                <select class="filter-select" id="filterPalette">
                    <option value="">All Palettes</option>
                </select>
            </div>
            
            <div class="filter-section">
                <h3>Lighting</h3>
                <select class="filter-select" id="filterLighting">
                    <option value="">All Lighting</option>
                </select>
            </div>
            
            <div class="filter-section">
                <button class="clear-filters-btn" id="clearFiltersBtn">Clear All Filters</button>
            </div>
            
            <!-- Reset/Apply Buttons -->
            <div class="filter-actions">
                <button class="reset-btn" id="resetFiltersBtn">Reset</button>
                <button class="apply-btn" id="applyFiltersBtn">Apply</button>
            </div>
        </aside>
        
        <!-- Styles Grid -->
        <main class="styles-main">
            <!-- Sticky Header -->
            <div class="sticky-header">
                <div class="search-bar">
                    <div class="search-input-wrapper">
                        <input type="text" class="search-input" id="searchInput" placeholder="Search styles...">
                        <button class="advanced-search-btn" id="advancedSearchBtn" title="Advanced search options">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                            </svg>
                        </button>
                        <button class="search-clear-btn" id="searchClearBtn" title="Clear search"></button>
                        
                        <!-- Advanced Search Dropdown -->
                        <div class="advanced-search-dropdown" id="advancedSearchDropdown">
                            <h4>Search Options</h4>
                            <div class="search-filter-group">
                                <label class="search-filter-label">
                                    <input type="radio" name="searchField" value="all" checked>
                                    Search all fields
                                </label>
                                <label class="search-filter-label">
                                    <input type="radio" name="searchField" value="name">
                                    Title only
                                </label>
                                <label class="search-filter-label">
                                    <input type="radio" name="searchField" value="tagline">
                                    Tagline only
                                </label>
                                <label class="search-filter-label">
                                    <input type="radio" name="searchField" value="tags">
                                    Tags only
                                </label>
                            </div>
                            <h4>Match Type</h4>
                            <div class="search-filter-group">
                                <label class="search-filter-label">
                                    <input type="radio" name="matchType" value="any" checked>
                                    Match any word
                                </label>
                                <label class="search-filter-label">
                                    <input type="radio" name="matchType" value="all">
                                    Match all words
                                </label>
                                <label class="search-filter-label">
                                    <input type="radio" name="matchType" value="exact">
                                    Exact phrase
                                </label>
                            </div>
                            <button class="search-apply-btn" id="applySearchOptions">Apply</button>
                        </div>
                    </div>
                    <div class="sort-container">
                        <label for="sortSelect">Sort:</label>
                        <select class="sort-select" id="sortSelect">
                            <option value="quality">Quality: High to Low</option>
                            <option value="qualityAsc">Quality: Low to High</option>
                            <option value="newest">Newest Arrivals</option>
                            <option value="featured">Featured</option>
                            <option value="nameAsc">Name: A to Z</option>
                            <option value="nameDesc">Name: Z to A</option>
                        </select>
                    </div>
                    <div class="quality-filter-container">
                        <label for="qualityFilter">Min:</label>
                        <select class="quality-filter-select" id="qualityFilter">
                            <option value="0">All</option>
                            <option value="6">6+</option>
                            <option value="7">7+</option>
                            <option value="8">8+</option>
                            <option value="9">9+</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                </div>
                
                <!-- Active Filter Pills -->
                <div class="filter-pills" id="filterPills">
                    <!-- Filter pills inserted dynamically -->
                </div>
                
                <div class="search-meta">
                    <span class="search-hint">Tip: Use multiple words to narrow results</span>
                    <span class="results-count" id="resultsCount">Loading...</span>
                </div>
            </div>
            
            <!-- Scrollable Content -->
            <div class="styles-content">
                <div class="styles-grid" id="stylesGrid">
                    <!-- Styles will be inserted here -->
                </div>
                
                <div class="pagination" id="pagination">
                    <button class="pagination-btn" id="prevPageBtn" disabled> Previous</button>
                    <span class="pagination-info" id="paginationInfo">Page 1 of 1</span>
                    <button class="pagination-btn" id="nextPageBtn">Next </button>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Multi-select Action Bar -->
    <div class="multi-select-bar" id="multiSelectBar">
        <span class="multi-select-count"><span id="selectedCount">0</span> selected</span>
        <button onclick="bulkFavorite()">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
            Favorite
        </button>
        <button onclick="bulkAddToProject()">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                <line x1="12" y1="11" x2="12" y2="17"></line>
                <line x1="9" y1="14" x2="15" y2="14"></line>
            </svg>
            Add to Project
        </button>
        <button onclick="bulkUnlist()" id="bulkUnlistBtn" class="danger-btn" style="display: none;">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line>
            </svg>
            Unlist Selected
        </button>
        <button class="cancel-btn" onclick="clearSelection()"> Cancel</button>
    </div>
    
    <!-- Style Detail Modal -->
    <div class="style-modal" id="styleModal">
        <div class="style-modal-content">
            <button class="style-modal-close" id="styleModalClose"></button>
            <div class="style-modal-gallery" id="styleModalGallery">
                <!-- Images inserted here -->
            </div>
            <div class="style-modal-info">
                <!-- Title (editable for admins) -->
                <div class="style-modal-title-row">
                    <h2 class="style-modal-name" id="styleModalName"></h2>
                    <button class="style-modal-edit-btn" id="styleModalEditTitle" onclick="toggleEditTitle()" style="display: none;" title="Edit title">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </button>
                </div>
                <input type="text" class="style-modal-name-input" id="styleModalNameInput" style="display: none;" onkeydown="handleTitleKeydown(event)" onblur="saveTitle()">
                
                <!-- Tagline -->
                <div class="style-modal-tagline" id="styleModalTagline"></div>
                
                <!-- Description (editable for admins) -->
                <div class="style-modal-description-row">
                    <p class="style-modal-description" id="styleModalDescription"></p>
                    <button class="style-modal-edit-btn" id="styleModalEditDesc" onclick="toggleEditDescription()" style="display: none;" title="Edit description">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                    </button>
                </div>
                <textarea class="style-modal-desc-input" id="styleModalDescInput" style="display: none;" onblur="saveDescription()" rows="4"></textarea>
                
                <!-- Style Number -->
                <div class="style-modal-id" id="styleModalId"></div>
                
                <!-- Action Buttons (Favorite, Add to Project) -->
                <div class="style-modal-actions" id="styleModalActions">
                    <button class="style-modal-action-btn favorite" id="styleModalFavoriteBtn" onclick="toggleStyleFavorite()">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
                        <span id="styleModalFavoriteBtnText">Favorite</span>
                    </button>
                    <button class="style-modal-action-btn primary" onclick="addStyleToProject()">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Add to Project
                    </button>
                </div>
                
                <!-- Admin Actions (shown only for super admins) -->
                <div class="style-modal-admin-actions" id="styleModalAdminActions" style="display: none;">
                    <button class="style-modal-action-btn admin" onclick="flagStyleForReview()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path>
                            <line x1="4" y1="22" x2="4" y2="15"></line>
                        </svg>
                        Flag for Review
                    </button>
                    <button class="style-modal-action-btn admin danger" onclick="unlistStyle()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line>
                        </svg>
                        Unlist Style
                    </button>
                </div>
                
                <!-- Tags Section (editable for admins) -->
                <div class="style-modal-tags-section">
                    <div class="style-modal-tags-header">
                        <span class="style-modal-section-label">Tags</span>
                        <button class="style-modal-edit-btn" id="styleModalEditTags" onclick="openTagsEditor()" style="display: none;" title="Edit tags">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="style-modal-tags" id="styleModalTags"></div>
                </div>
                
                <!-- Attributes Grid -->
                <div class="style-modal-attributes" id="styleModalAttributes">
                    <!-- Attributes inserted here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Lightbox for zoomed images -->
    <div class="lightbox" id="lightbox">
        <div class="lightbox-content">
            <button class="lightbox-close" id="lightboxClose"></button>
            <button class="lightbox-nav lightbox-prev" id="lightboxPrev"></button>
            <img class="lightbox-image" id="lightboxImage" src="" alt="Zoomed style image">
            <button class="lightbox-nav lightbox-next" id="lightboxNext"></button>
            <div class="lightbox-counter" id="lightboxCounter">1 / 10</div>
            <div class="lightbox-zoom-hint">Click image to zoom in/out</div>
        </div>
    </div>
    
    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu">
        <div class="context-menu-header" id="contextMenuHeader">
            <!-- Style name inserted dynamically -->
        </div>
        <button class="context-menu-item" id="menuSave">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                <polyline points="17 21 17 13 7 13 7 21"></polyline>
                <polyline points="7 3 7 8 15 8"></polyline>
            </svg>
            Save
        </button>
        <button class="context-menu-item" id="menuAddToCollection">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
            </svg>
            Add to Collection
        </button>
        <div class="context-menu-divider"></div>
        <button class="context-menu-item" id="menuReportSwap">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Flag for Review
        </button>
        <button class="context-menu-item danger" id="menuReportDelete">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
            Unlist Style
        </button>
    </div>
    
    <!-- Collection Modal -->
    <div class="collection-modal" id="collectionModal">
        <div class="collection-modal-content">
            <div class="collection-modal-header">
                <h3>Add to Collection</h3>
                <button class="collection-modal-close" id="collectionModalClose"></button>
            </div>
            <div class="collection-modal-body">
                <div class="collection-list" id="collectionList">
                    <!-- Collections inserted here -->
                </div>
                <div class="create-collection-form">
                    <input type="text" class="create-collection-input" id="newCollectionName" placeholder="New collection name...">
                    <button class="create-collection-btn" id="createCollectionBtn">Create</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast -->
    <div class="toast" id="toast"></div>
    
    <!-- Confirmation Modal -->
    <div class="confirm-modal" id="confirmModal">
        <div class="confirm-modal-content">
            <div class="confirm-modal-icon"></div>
            <h3 class="confirm-modal-title">Unlist This Style?</h3>
            <p class="confirm-modal-text">This will remove the style from the public gallery. It can be restored later by an admin.</p>
            <div class="confirm-modal-buttons">
                <button class="confirm-btn confirm-btn-cancel" id="confirmCancel">Cancel</button>
                <button class="confirm-btn confirm-btn-danger" id="confirmUnlist">Yes, Unlist</button>
            </div>
        </div>
    </div>
    
    <!-- AUTH MODAL: Now handled by shared auth.js -->
    
        <!-- ============================================ -->
    <!-- PROFILE MODAL -->
    <!-- ============================================ -->
    <div class="auth-modal-overlay" id="profileModalOverlay">
        <div class="auth-modal profile-modal" id="profileModal">
            <button class="auth-modal-close" onclick="closeProfileModal()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            
            <div class="profile-header">
                <div class="profile-avatar-section">
                    <div class="profile-avatar" id="profileAvatar">
                        <span id="profileInitials">U</span>
                    </div>
                    <label class="profile-avatar-edit" for="avatarUpload">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                            <circle cx="12" cy="13" r="4"></circle>
                        </svg>
                    </label>
                    <input type="file" id="avatarUpload" accept="image/*" style="display: none;" onchange="handleAvatarUpload(event)">
                </div>
                <div class="profile-info">
                    <h2 id="profileName">User Name</h2>
                    <p id="profileEmail">user@example.com</p>
                    <span class="profile-role-badge" id="profileRole" style="display: none;">Admin</span>
                </div>
            </div>
            
            <div class="profile-section">
                <h3 class="profile-section-title">Account Information</h3>
                <div class="profile-field">
                    <span class="profile-field-label">Display Name</span>
                    <div class="profile-field-value">
                        <span class="profile-field-text" id="profileDisplayName">User</span>
                        <span class="profile-field-edit" onclick="editProfileField('displayName')">Edit</span>
                    </div>
                </div>
                <div class="profile-field">
                    <span class="profile-field-label">Email</span>
                    <div class="profile-field-value">
                        <span class="profile-field-text" id="profileEmailField">user@example.com</span>
                    </div>
                </div>
                <div class="profile-field">
                    <span class="profile-field-label">Password</span>
                    <div class="profile-field-value">
                        <span class="profile-field-text"></span>
                        <span class="profile-field-edit" onclick="editProfileField('password')">Change</span>
                    </div>
                </div>
            </div>
            
            <div class="profile-section" id="profileAdminSection" style="display: none;">
                <h3 class="profile-section-title">Admin Settings</h3>
                <div class="profile-field">
                    <span class="profile-field-label">Role</span>
                    <div class="profile-field-value">
                        <span class="profile-field-text" id="profileRoleText">Admin</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ============================================ -->
    <!-- EDIT STYLE MODAL (Admin Only) -->
    <!-- ============================================ -->
    <div class="auth-modal-overlay" id="editStyleModalOverlay">
        <div class="auth-modal edit-style-modal" id="editStyleModal">
            <button class="auth-modal-close" onclick="closeEditStyleModal()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            
            <div class="edit-style-header">
                <div class="edit-style-thumbnail" id="editStyleThumbnail">
                    <img src="" alt="Style thumbnail">
                </div>
                <div class="edit-style-meta">
                    <h3>Edit Style</h3>
                    <span class="edit-style-id" id="editStyleId">ABC-123</span>
                    <p class="edit-style-id-note">Style ID cannot be changed</p>
                </div>
            </div>
            
            <form class="auth-form" id="editStyleForm" onsubmit="handleSaveStyle(event)">
                <div class="edit-form-section">
                    <h4 class="edit-form-section-title">Basic Information</h4>
                    
                    <div class="edit-form-group">
                        <label class="edit-form-label">Style Name</label>
                        <input type="text" class="edit-form-input" id="editStyleName" placeholder="Enter style name" required>
                    </div>
                    
                    <div class="edit-form-group">
                        <label class="edit-form-label">Tagline</label>
                        <input type="text" class="edit-form-input" id="editStyleTagline" placeholder="Short description">
                    </div>
                    
                    <div class="edit-form-group">
                        <label class="edit-form-label">Description</label>
                        <textarea class="edit-form-input edit-form-textarea" id="editStyleDescription" placeholder="Full description"></textarea>
                    </div>
                </div>
                
                <div class="edit-form-section">
                    <h4 class="edit-form-section-title">Categories</h4>
                    
                    <div class="edit-category-grid">
                        <div class="edit-form-group">
                            <label class="edit-form-label">Art Type</label>
                            <select class="edit-form-select" id="editStyleArtType">
                                <option value="">Select art type...</option>
                            </select>
                        </div>
                        
                        <div class="edit-form-group">
                            <label class="edit-form-label">Medium</label>
                            <select class="edit-form-select" id="editStyleMedium">
                                <option value="">Select medium...</option>
                            </select>
                        </div>
                        
                        <div class="edit-form-group">
                            <label class="edit-form-label">Era</label>
                            <select class="edit-form-select" id="editStyleEra">
                                <option value="">Select era...</option>
                            </select>
                        </div>
                        
                        <div class="edit-form-group">
                            <label class="edit-form-label">Culture</label>
                            <select class="edit-form-select" id="editStyleCulture">
                                <option value="">Select culture...</option>
                            </select>
                        </div>
                        
                        <div class="edit-form-group">
                            <label class="edit-form-label">Palette</label>
                            <select class="edit-form-select" id="editStylePalette">
                                <option value="">Select palette...</option>
                            </select>
                        </div>
                        
                        <div class="edit-form-group">
                            <label class="edit-form-label">Lighting</label>
                            <select class="edit-form-select" id="editStyleLighting">
                                <option value="">Select lighting...</option>
                            </select>
                        </div>
                        
                        <div class="edit-form-group">
                            <label class="edit-form-label">Composition</label>
                            <select class="edit-form-select" id="editStyleComposition">
                                <option value="">Select composition...</option>
                            </select>
                        </div>
                        
                        <div class="edit-form-group">
                            <label class="edit-form-label">Complexity</label>
                            <select class="edit-form-select" id="editStyleComplexity">
                                <option value="">Select complexity...</option>
                                <option value="1">1 - Simple</option>
                                <option value="2">2 - Low</option>
                                <option value="3">3 - Medium</option>
                                <option value="4">4 - High</option>
                                <option value="5">5 - Complex</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="edit-form-section">
                    <h4 class="edit-form-section-title">Visibility</h4>
                    <div class="edit-form-group">
                        <label class="checkbox-wrapper">
                            <div class="checkbox" id="editStyleFeaturedCheckbox">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                            </div>
                            <span class="checkbox-label">Featured Style</span>
                        </label>
                    </div>
                    <div class="edit-form-group">
                        <label class="checkbox-wrapper">
                            <div class="checkbox" id="editStyleNewCheckbox">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3">
                                    <polyline points="20 6 9 17 4 12"></polyline>
                                </svg>
                            </div>
                            <span class="checkbox-label">Mark as New</span>
                        </label>
                    </div>
                </div>
                
                <div class="edit-modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeEditStyleModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="saveStyleBtn">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/shared/supabase-client.js"></script>
    <script src="js/shared/auth.js"></script>
    <script src="js/shared/header.js"></script>
    <script src="js/shared/projects.js"></script>
    <script src="js/style-finder/style-data.js"></script>
    <script>
        // ============================================
        // DOM Elements
        // ============================================
        const loadingOverlay = document.getElementById('loadingOverlay');
        const stylesGrid = document.getElementById('stylesGrid');
        const searchInput = document.getElementById('searchInput');
        const searchClearBtn = document.getElementById('searchClearBtn');
        const sidebarSearch = document.getElementById('sidebarSearch');
        const resultsCount = document.getElementById('resultsCount');
        const prevPageBtn = document.getElementById('prevPageBtn');
        const nextPageBtn = document.getElementById('nextPageBtn');
        const paginationInfo = document.getElementById('paginationInfo');
        const clearFiltersBtn = document.getElementById('clearFiltersBtn');
        const resetFiltersBtn = document.getElementById('resetFiltersBtn');
        const applyFiltersBtn = document.getElementById('applyFiltersBtn');
        const filterPills = document.getElementById('filterPills');
        const styleModal = document.getElementById('styleModal');
        const styleModalClose = document.getElementById('styleModalClose');
        const lightbox = document.getElementById('lightbox');
        const lightboxImage = document.getElementById('lightboxImage');
        const lightboxCounter = document.getElementById('lightboxCounter');
        const contextMenu = document.getElementById('contextMenu');
        const collectionModal = document.getElementById('collectionModal');
        const toast = document.getElementById('toast');
        const activeFiltersDisplay = document.getElementById('activeFiltersDisplay');
        const sortSelect = document.getElementById('sortSelect');
        const qualityFilter = document.getElementById('qualityFilter');
        const confirmModal = document.getElementById('confirmModal');
        
        // Note: toggleNavSidebar, closeNavSidebar are provided by header.js
        
        // Filter elements mapped to database columns
        const filterSelects = {
            art_type_id: document.getElementById('filterArtType'),
            primary_medium_id: document.getElementById('filterMedium'),
            culture_id: document.getElementById('filterCulture'),
            era_id: document.getElementById('filterEra'),
            primary_palette_id: document.getElementById('filterPalette'),
            primary_lighting_id: document.getElementById('filterLighting')
        };
        
        // Lookup table mapping for smart facets
        const filterConfig = {
            art_type_id: { lookup: 'art_types', label: 'Art Type' },
            primary_medium_id: { lookup: 'mediums', label: 'Medium' },
            culture_id: { lookup: 'cultures', label: 'Culture' },
            era_id: { lookup: 'eras', label: 'Era' },
            primary_palette_id: { lookup: 'palettes', label: 'Palette' },
            primary_lighting_id: { lookup: 'lighting', label: 'Lighting' }
        };
        
        // State for lightbox
        let lightboxImages = [];
        let lightboxIndex = 0;
        let isZoomed = false;
        
        // State for context menu
        let currentMenuStyleId = null;
        let currentMenuImageUrl = null;
        
        // ============================================
        // Initialize
        // ============================================
        async function initialize() {
            showLoading(true);
            
            try {
                await SocietyArts.initializeStyleData();
                populateFilterDropdowns();
                renderStyles();
                updateResultsCount();
                updatePagination();
            } catch (error) {
                console.error('Initialization failed:', error);
                stylesGrid.innerHTML = '<p style="text-align:center;color:#999;padding:2rem;">Failed to load styles. Please refresh the page.</p>';
            } finally {
                showLoading(false);
            }
        }
        
        // ============================================
        // UI Functions
        // ============================================
        function showLoading(show) {
            loadingOverlay.classList.toggle('active', show);
        }
        
        function showToast(message, duration = 3000) {
            toast.textContent = message;
            toast.classList.add('active');
            setTimeout(() => toast.classList.remove('active'), duration);
        }
        
        // Populate dropdowns with counts (smart facets)
        function populateFilterDropdowns() {
            // Get actual filtered count (not sum of options)
            const totalFilteredStyles = SocietyArts.filteredStyles().length;
            
            Object.entries(filterSelects).forEach(([filterKey, selectEl]) => {
                if (filterKey === 'complexity') return; // Skip complexity
                
                const config = filterConfig[filterKey];
                if (!config) return;
                
                // Get options with counts
                const options = SocietyArts.getLookupOptionsWithCounts(config.lookup, filterKey);
                
                // Save current selection
                const currentValue = selectEl.value;
                
                // Clear and rebuild - show actual filtered count, not sum of options
                selectEl.innerHTML = `<option value="">All ${config.label}s (${totalFilteredStyles})</option>`;
                
                // Add options that have results, with counts
                options.forEach(opt => {
                    const option = document.createElement('option');
                    option.value = opt.id;
                    option.textContent = `${opt.name} (${opt.count})`;
                    selectEl.appendChild(option);
                });
                
                // Restore selection if still valid
                if (currentValue && [...selectEl.options].some(o => o.value === currentValue)) {
                    selectEl.value = currentValue;
                }
                
                console.log(`Populated ${filterKey} with ${options.length} options (with counts)`);
            });
        }
        
        function updateActiveFiltersDisplay() {
            const activeFilters = [];
            Object.entries(filterSelects).forEach(([key, el]) => {
                if (el.value) {
                    const selectedOption = el.options[el.selectedIndex];
                    activeFilters.push(selectedOption.textContent.split(' (')[0]); // Remove count
                }
            });
            
            if (activeFilters.length > 0) {
                activeFiltersDisplay.style.display = 'block';
                activeFiltersDisplay.textContent = `Active: ${activeFilters.join(', ')}`;
            } else {
                activeFiltersDisplay.style.display = 'none';
            }
        }
        
        function renderStyles() {
            const styles = SocietyArts.getCurrentPageStyles();
            
            if (styles.length === 0) {
                stylesGrid.innerHTML = '<p style="text-align:center;color:#999;padding:2rem;grid-column:1/-1;">No styles found matching your criteria.</p>';
                return;
            }
            
            stylesGrid.innerHTML = styles.map(style => `
                <div class="style-card" data-style-id="${style.id}">
                    <div class="style-card-image">
                        <img src="${style.thumbnail}" alt="${style.name}" 
                             onerror="this.parentElement.innerHTML='<div class=\\'placeholder\\'>Image not available</div>'">
                        <button class="select-checkbox" 
                                onclick="event.stopPropagation(); toggleStyleSelection('${style.id}')"
                                title="Select for bulk action">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                <polyline points="20 6 9 17 4 12"></polyline>
                            </svg>
                        </button>
                        <button class="favorite-btn ${isStyleFavorited(style.id) ? 'active' : ''}" 
                                onclick="event.stopPropagation(); toggleFavorite('${style.id}', this)"
                                title="Add to favorites">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                            </svg>
                        </button>
                        <button class="menu-btn-horizontal" 
                                onclick="event.stopPropagation(); openContextMenu(event, '${style.id}', '${style.thumbnail}')"
                                title="More options">
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                        </button>
                    </div>
                    <div class="style-card-info">
                        <h3 class="style-card-name">${style.name || 'Untitled Style'}</h3>
                        ${style.tagline ? `<div class="style-card-tagline">${style.tagline}</div>` : ''}
                    </div>
                </div>
            `).join('');
            
            document.querySelectorAll('.style-card').forEach(card => {
                card.addEventListener('click', () => openStyleModal(card.dataset.styleId));
            });
        }
        
        function updateResultsCount() {
            const total = SocietyArts.filteredStyles().length;
            resultsCount.textContent = `${total.toLocaleString()} style${total !== 1 ? 's' : ''}`;
        }
        
        function updatePagination() {
            const currentPage = SocietyArts.currentPage();
            const totalPages = SocietyArts.getTotalPages();
            
            prevPageBtn.disabled = currentPage === 0;
            nextPageBtn.disabled = currentPage >= totalPages - 1;
            paginationInfo.textContent = `Page ${currentPage + 1} of ${Math.max(1, totalPages)}`;
        }
        
        // ============================================
        // Search & Filter Handlers
        // ============================================
        let searchTimeout;
        async function handleSearch(value) {
            // Show/hide clear button
            searchClearBtn.classList.toggle('visible', value.length > 0);
            
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(async () => {
                showLoading(true);
                await SocietyArts.searchStyles(value);
                renderStyles();
                updateResultsCount();
                updatePagination();
                updateFilterPills();
                showLoading(false);
            }, 300);
        }
        
        searchInput.addEventListener('input', (e) => handleSearch(e.target.value));
        
        // Advanced Search Toggle
        const advancedSearchBtn = document.getElementById('advancedSearchBtn');
        const advancedSearchDropdown = document.getElementById('advancedSearchDropdown');
        const applySearchOptions = document.getElementById('applySearchOptions');
        
        // Search options state
        let searchOptions = {
            field: 'all',
            matchType: 'any'
        };
        
        advancedSearchBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            advancedSearchDropdown.classList.toggle('open');
            advancedSearchBtn.classList.toggle('active', advancedSearchDropdown.classList.contains('open'));
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!advancedSearchDropdown.contains(e.target) && e.target !== advancedSearchBtn) {
                advancedSearchDropdown.classList.remove('open');
                advancedSearchBtn.classList.remove('active');
            }
        });
        
        applySearchOptions.addEventListener('click', () => {
            // Get selected options
            const fieldRadio = document.querySelector('input[name="searchField"]:checked');
            const matchRadio = document.querySelector('input[name="matchType"]:checked');
            
            searchOptions.field = fieldRadio ? fieldRadio.value : 'all';
            searchOptions.matchType = matchRadio ? matchRadio.value : 'any';
            
            // Close dropdown
            advancedSearchDropdown.classList.remove('open');
            advancedSearchBtn.classList.toggle('active', searchOptions.field !== 'all' || searchOptions.matchType !== 'any');
            
            // Re-run search with new options
            handleSearch(searchInput.value);
        });
        
        // Search clear button
        searchClearBtn.addEventListener('click', async () => {
            searchInput.value = '';
            searchClearBtn.classList.remove('visible');
            showLoading(true);
            await SocietyArts.searchStyles('');
            renderStyles();
            updateResultsCount();
            updatePagination();
            updateFilterPills();
            showLoading(false);
        });
        
        sidebarSearch.addEventListener('input', (e) => {
            searchInput.value = e.target.value;
            handleSearch(e.target.value);
        });
        
        // Filter change handler - instant apply
        Object.entries(filterSelects).forEach(([filterKey, selectEl]) => {
            selectEl.addEventListener('change', async () => {
                console.log(`Filter changed: ${filterKey} = "${selectEl.value}"`);
                
                showLoading(true);
                
                const filters = {};
                Object.entries(filterSelects).forEach(([key, el]) => {
                    if (el.value) {
                        if (key === 'complexity') {
                            filters[key] = parseInt(el.value);
                        } else {
                            filters[key] = el.value;
                        }
                    }
                });
                
                console.log('Applying filters:', filters);
                
                await SocietyArts.applyFilters(filters);
                
                // Refresh dropdowns with new counts (smart facets)
                populateFilterDropdowns();
                
                renderStyles();
                updateResultsCount();
                updatePagination();
                updateActiveFiltersDisplay();
                updateFilterPills();
                
                showLoading(false);
            });
        });
        
        // Clear all filters (sidebar button)
        clearFiltersBtn.addEventListener('click', async () => {
            await resetAllFilters();
        });
        
        // Reset button (sticky footer)
        resetFiltersBtn.addEventListener('click', async () => {
            await resetAllFilters();
        });
        
        // Apply button (currently instant-apply, but kept for UX consistency)
        applyFiltersBtn.addEventListener('click', () => {
            showToast('Filters applied!', 1500);
        });
        
        async function resetAllFilters() {
            showLoading(true);
            Object.values(filterSelects).forEach(el => el.value = '');
            searchInput.value = '';
            searchClearBtn.classList.remove('visible');
            if (sidebarSearch) sidebarSearch.value = '';
            qualityFilter.value = '0';
            await SocietyArts.setQualityThreshold(0);
            await SocietyArts.clearFilters();
            populateFilterDropdowns();
            renderStyles();
            updateResultsCount();
            updatePagination();
            updateActiveFiltersDisplay();
            updateFilterPills();
            showLoading(false);
        }
        
        // Update filter pills display
        function updateFilterPills() {
            const pills = [];
            const lookups = SocietyArts.getLookups();
            
            // Add search term pill
            const searchTerm = searchInput.value.trim();
            if (searchTerm) {
                pills.push(`<span class="filter-pill">
                    Search: "${searchTerm}"
                    <button class="filter-pill-remove" data-action="clear-search"></button>
                </span>`);
            }
            
            // Add filter pills
            Object.entries(filterSelects).forEach(([filterKey, selectEl]) => {
                if (selectEl.value) {
                    const config = filterConfig[filterKey];
                    let displayValue = selectEl.value;
                    
                    if (config && lookups[config.lookup]) {
                        const item = lookups[config.lookup].find(l => l.id === selectEl.value);
                        if (item) displayValue = item.name;
                    } else if (filterKey === 'complexity') {
                        displayValue = selectEl.options[selectEl.selectedIndex].text;
                    }
                    
                    const label = config?.label || filterKey;
                    pills.push(`<span class="filter-pill">
                        ${label}: ${displayValue}
                        <button class="filter-pill-remove" data-filter="${filterKey}"></button>
                    </span>`);
                }
            });
            
            // Add quality filter pill
            const qualityValue = parseInt(qualityFilter.value);
            if (qualityValue > 0) {
                pills.push(`<span class="filter-pill">
                    Quality: ${qualityValue}+
                    <button class="filter-pill-remove" data-action="clear-quality"></button>
                </span>`);
            }
            
            // Add reset all button if there are any filters
            if (pills.length > 0) {
                pills.push(`<button class="reset-all-btn" id="resetAllPillsBtn">Reset All</button>`);
            }
            
            filterPills.innerHTML = pills.join('');
            
            // Add event listeners to pill remove buttons
            filterPills.querySelectorAll('.filter-pill-remove').forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    e.stopPropagation();
                    const filterKey = btn.dataset.filter;
                    const action = btn.dataset.action;
                    
                    if (action === 'clear-search') {
                        searchInput.value = '';
                        searchClearBtn.classList.remove('visible');
                        showLoading(true);
                        await SocietyArts.searchStyles('');
                    } else if (action === 'clear-quality') {
                        qualityFilter.value = '0';
                        showLoading(true);
                        await SocietyArts.setQualityThreshold(0);
                    } else if (filterKey) {
                        filterSelects[filterKey].value = '';
                        showLoading(true);
                        const filters = {};
                        Object.entries(filterSelects).forEach(([key, el]) => {
                            if (el.value) filters[key] = el.value;
                        });
                        await SocietyArts.applyFilters(filters);
                        populateFilterDropdowns();
                    }
                    
                    renderStyles();
                    updateResultsCount();
                    updatePagination();
                    updateActiveFiltersDisplay();
                    updateFilterPills();
                    showLoading(false);
                });
            });
            
            // Reset all button
            const resetAllBtn = filterPills.querySelector('#resetAllPillsBtn');
            if (resetAllBtn) {
                resetAllBtn.addEventListener('click', () => resetAllFilters());
            }
        }
        
        // Sort handler
        sortSelect.addEventListener('change', async () => {
            showLoading(true);
            await SocietyArts.setSort(sortSelect.value);
            renderStyles();
            updatePagination();
            showLoading(false);
        });
        
        // Quality filter handler
        qualityFilter.addEventListener('change', async () => {
            showLoading(true);
            await SocietyArts.setQualityThreshold(parseInt(qualityFilter.value));
            populateFilterDropdowns();
            renderStyles();
            updateResultsCount();
            updatePagination();
            showLoading(false);
        });
        
        // ============================================
        // Pagination
        // ============================================
        prevPageBtn.addEventListener('click', () => {
            SocietyArts.prevPage();
            renderStyles();
            updatePagination();
            document.querySelector('.styles-main').scrollTo(0, 0);
        });
        
        nextPageBtn.addEventListener('click', () => {
            SocietyArts.nextPage();
            renderStyles();
            updatePagination();
            document.querySelector('.styles-main').scrollTo(0, 0);
        });
        
        // ============================================
        // Multi-Select Functionality
        // ============================================
        let selectedStyles = new Set();
        const multiSelectBar = document.getElementById('multiSelectBar');
        const selectedCountEl = document.getElementById('selectedCount');
        const bulkUnlistBtn = document.getElementById('bulkUnlistBtn');
        
        function toggleStyleSelection(styleId) {
            const card = document.querySelector(`.style-card[data-style-id="${styleId}"]`);
            
            if (selectedStyles.has(styleId)) {
                selectedStyles.delete(styleId);
                card?.classList.remove('selected');
            } else {
                selectedStyles.add(styleId);
                card?.classList.add('selected');
            }
            
            updateMultiSelectBar();
        }
        
        function updateMultiSelectBar() {
            const count = selectedStyles.size;
            selectedCountEl.textContent = count;
            
            if (count > 0) {
                multiSelectBar.classList.add('visible');
                document.body.classList.add('multi-select-active');
                
                // Show unlist button only for super admins
                bulkUnlistBtn.style.display = isSuperAdmin() ? 'flex' : 'none';
            } else {
                multiSelectBar.classList.remove('visible');
                document.body.classList.remove('multi-select-active');
            }
        }
        
        function clearSelection() {
            selectedStyles.forEach(styleId => {
                const card = document.querySelector(`.style-card[data-style-id="${styleId}"]`);
                card?.classList.remove('selected');
            });
            selectedStyles.clear();
            updateMultiSelectBar();
        }
        
        async function bulkFavorite() {
            if (!currentUser) {
                showToast('Please sign in to favorite styles');
                openAuthModal();
                return;
            }
            
            const { supabase } = window.SocietyArts;
            const styleIds = Array.from(selectedStyles);
            let added = 0;
            
            for (const styleId of styleIds) {
                try {
                    // Check if already favorited using local function
                    if (!isStyleFavorited(styleId)) {
                        // Get style name and add to favorites
                        const style = await SocietyArts.getStyleById(styleId);
                        const styleName = style?.name || null;
                        
                        const { error } = await supabase
                            .from('user_favorites')
                            .insert({
                                user_id: currentUser.id,
                                style_id: styleId,
                                style_name: styleName
                            });
                        
                        if (error && error.code !== '23505') {
                            throw error;
                        }
                        
                        localFavorites.unshift({
                            style_id: styleId,
                            style_name: styleName,
                            created_at: new Date().toISOString()
                        });
                        added++;
                        
                        // Update button state
                        const btn = document.querySelector(`.style-card[data-style-id="${styleId}"] .favorite-btn`);
                        btn?.classList.add('active');
                    }
                } catch (error) {
                    console.error(`Failed to add favorite ${styleId}:`, error);
                }
            }
            
            showToast(`Added ${added} style${added !== 1 ? 's' : ''} to favorites`);
            clearSelection();
        }
        
        function bulkAddToProject() {
            if (!currentUser) {
                showToast('Please sign in to add to project');
                return;
            }
            
            const styleIds = Array.from(selectedStyles);
            
            // Store in session storage and redirect to story builder
            sessionStorage.setItem('pendingStyles', JSON.stringify(styleIds));
            window.location.href = 'story-builder.html?addStyles=pending';
        }
        
        async function bulkUnlist() {
            if (!currentUser) {
                showToast('Please sign in');
                return;
            }
            
            const styleIds = Array.from(selectedStyles);
            const confirmed = confirm(`Unlist ${styleIds.length} styles? They will no longer appear in search results.`);
            
            if (!confirmed) return;
            
            try {
                const { error } = await supabase
                    .from('styles')
                    .update({ status: 'unlisted' })
                    .in('id', styleIds);
                
                if (error) throw error;
                
                showToast(`${styleIds.length} styles unlisted`);
                clearSelection();
                SocietyArts.loadStyles().then(() => {
                    renderStyles();
                    updateResultsCount();
                });
            } catch (err) {
                showToast('Error unlisting styles');
                console.error(err);
            }
        }
        
        // ============================================
        // Favorites (Database-backed)
        // ============================================
        
        // Local favorites cache for style-finder
        let localFavorites = [];
        
        // Load user's favorites on auth
        async function loadUserFavoritesLocal() {
            if (!currentUser) {
                localFavorites = [];
                return [];
            }
            
            const { supabase } = window.SocietyArts;
            try {
                const { data, error } = await supabase
                    .from('user_favorites')
                    .select('style_id, style_name, created_at')
                    .eq('user_id', currentUser.id)
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                localFavorites = data || [];
                console.log(`Loaded ${localFavorites.length} favorites for user`);
                return localFavorites;
            } catch (error) {
                console.error('Failed to load favorites:', error);
                return [];
            }
        }
        
        // Check if a style is favorited
        function isStyleFavorited(styleId) {
            return localFavorites.some(f => f.style_id === styleId);
        }
        
        // Toggle favorite on a style
        async function toggleFavorite(styleId, btn) {
            // Check if user is logged in
            if (!currentUser) {
                showToast('Please sign in to save favorites');
                openAuthModal();
                return;
            }
            
            const { supabase } = window.SocietyArts;
            
            try {
                if (isStyleFavorited(styleId)) {
                    // Remove from favorites
                    const { error } = await supabase
                        .from('user_favorites')
                        .delete()
                        .eq('user_id', currentUser.id)
                        .eq('style_id', styleId);
                    
                    if (error) throw error;
                    
                    localFavorites = localFavorites.filter(f => f.style_id !== styleId);
                    btn.classList.remove('active');
                    showToast('Removed from favorites');
                } else {
                    // Add to favorites - get style name first
                    const style = await SocietyArts.getStyleById(styleId);
                    const styleName = style?.name || null;
                    
                    const { error } = await supabase
                        .from('user_favorites')
                        .insert({
                            user_id: currentUser.id,
                            style_id: styleId,
                            style_name: styleName
                        });
                    
                    if (error) {
                        // Ignore duplicate key error
                        if (error.code !== '23505') {
                            throw error;
                        }
                    }
                    
                    localFavorites.unshift({
                        style_id: styleId,
                        style_name: styleName,
                        created_at: new Date().toISOString()
                    });
                    btn.classList.add('active');
                    showToast('Added to favorites');
                }
            } catch (error) {
                console.error('Failed to toggle favorite:', error);
                showToast('Failed to update favorites');
            }
        }
        
        // ============================================
        // Style Modal - Now shows all related attributes
        // ============================================
        async function openStyleModal(styleId) {
            showLoading(true);
            const style = await SocietyArts.getStyleById(styleId);
            showLoading(false);
            
            if (!style) return;
            
            lightboxImages = style.images;
            
            // Store current style data for editing
            currentModalStyleId = styleId;
            currentModalStyleName = style.name;
            currentModalStyle = style;
            
            const galleryHtml = style.images.map((url, i) => 
                `<img src="${url}" alt="${style.name} - Image ${i + 1}" 
                      onclick="openLightbox(${i})"
                      onerror="this.style.display='none'">`
            ).join('');
            document.getElementById('styleModalGallery').innerHTML = galleryHtml;
            
            // Set title
            document.getElementById('styleModalName').textContent = style.name || 'Untitled Style';
            document.getElementById('styleModalNameInput').value = style.name || '';
            
            // Set tagline
            document.getElementById('styleModalTagline').textContent = style.tagline || '';
            
            // Set description
            document.getElementById('styleModalDescription').textContent = style.description || 'No description available.';
            document.getElementById('styleModalDescInput').value = style.description || '';
            
            // Set style ID
            document.getElementById('styleModalId').textContent = `Style #${style.id}`;
            
            // Show tags from junction tables
            const allTags = [
                ...(style.artTypes || []),
                ...(style.mediums || []),
                ...(style.cultures || []),
                ...(style.eras || []),
                ...(style.palettes || []),
                ...(style.lighting || []),
                ...(style.compositions || [])
            ];
            
            document.getElementById('styleModalTags').innerHTML = allTags.length > 0 
                ? allTags.map(tag => `<span class="style-tag">${tag}</span>`).join('')
                : '<span class="style-tag" style="opacity: 0.5;">No tags</span>';
            
            const attributes = [
                ['Art Types', style.artTypes?.join(', ')],
                ['Mediums', style.mediums?.join(', ')],
                ['Cultures', style.cultures?.join(', ')],
                ['Eras', style.eras?.join(', ')],
                ['Palettes', style.palettes?.join(', ')],
                ['Lighting', style.lighting?.join(', ')],
                ['Compositions', style.compositions?.join(', ')],
                ['Complexity', style.complexity ? `Level ${style.complexity}` : null],
                ['Best Format', style.best_format],
                ['Best Size', style.best_size],
                ['SREF Code', style.sref_code]
            ].filter(([_, value]) => value);
            
            document.getElementById('styleModalAttributes').innerHTML = attributes.map(([label, value]) => `
                <div class="attribute-item">
                    <div class="attribute-label">${label}</div>
                    <div class="attribute-value">${value}</div>
                </div>
            `).join('');
            
            // Update favorite button state
            updateFavoriteButtonState();
            
            // Show/hide admin actions and edit buttons based on role
            const isAdmin = isSuperAdmin();
            document.getElementById('styleModalAdminActions').style.display = isAdmin ? 'flex' : 'none';
            document.getElementById('styleModalEditTitle').style.display = isAdmin ? 'block' : 'none';
            document.getElementById('styleModalEditDesc').style.display = isAdmin ? 'block' : 'none';
            document.getElementById('styleModalEditTags').style.display = isAdmin ? 'block' : 'none';
            
            // Reset edit modes
            document.getElementById('styleModalName').style.display = 'block';
            document.getElementById('styleModalNameInput').style.display = 'none';
            document.getElementById('styleModalDescription').parentElement.style.display = 'flex';
            document.getElementById('styleModalDescInput').style.display = 'none';
            
            styleModal.classList.add('active');
        }
        
        // Variable to track current style in modal
        let currentModalStyleId = null;
        let currentModalStyleName = null;
        let currentModalStyle = null;
        
        // Update favorite button appearance
        function updateFavoriteButtonState() {
            const btn = document.getElementById('styleModalFavoriteBtn');
            const btnText = document.getElementById('styleModalFavoriteBtnText');
            const svg = btn.querySelector('svg');
            
            if (!currentUser) {
                btn.style.display = 'none';
                return;
            }
            
            btn.style.display = 'inline-flex';
            
            // Check if favorited using local function
            const isFavorited = isStyleFavorited(currentModalStyleId);
            
            if (isFavorited) {
                btn.classList.add('active');
                btnText.textContent = 'Favorited';
                svg.setAttribute('fill', 'currentColor');
            } else {
                btn.classList.remove('active');
                btnText.textContent = 'Favorite';
                svg.setAttribute('fill', 'none');
            }
        }
        
        // Toggle favorite on current modal style
        async function toggleStyleFavorite() {
            if (!currentUser) {
                openAuthModal();
                return;
            }
            
            if (!currentModalStyleId) return;
            
            const { supabase } = window.SocietyArts;
            
            try {
                if (isStyleFavorited(currentModalStyleId)) {
                    // Remove from favorites
                    const { error } = await supabase
                        .from('user_favorites')
                        .delete()
                        .eq('user_id', currentUser.id)
                        .eq('style_id', currentModalStyleId);
                    
                    if (error) throw error;
                    
                    localFavorites = localFavorites.filter(f => f.style_id !== currentModalStyleId);
                    showToast('Removed from favorites');
                } else {
                    // Add to favorites
                    const { error } = await supabase
                        .from('user_favorites')
                        .insert({
                            user_id: currentUser.id,
                            style_id: currentModalStyleId,
                            style_name: currentModalStyleName
                        });
                    
                    if (error && error.code !== '23505') {
                        throw error;
                    }
                    
                    localFavorites.unshift({
                        style_id: currentModalStyleId,
                        style_name: currentModalStyleName,
                        created_at: new Date().toISOString()
                    });
                    showToast('Added to favorites');
                }
                
                updateFavoriteButtonState();
                
                // Also update the card button if visible
                const cardBtn = document.querySelector(`.style-card[data-style-id="${currentModalStyleId}"] .favorite-btn`);
                if (cardBtn) {
                    cardBtn.classList.toggle('active', isStyleFavorited(currentModalStyleId));
                }
            } catch (error) {
                console.error('Failed to toggle favorite:', error);
                showToast('Failed to update favorite');
            }
        }
        
        // Add style to project (redirect to story builder)
        function addStyleToProject() {
            if (!currentModalStyleId) return;
            
            // Store selected style in sessionStorage
            const selectedStyles = JSON.parse(sessionStorage.getItem('selectedStyles') || '[]');
            if (!selectedStyles.includes(currentModalStyleId)) {
                selectedStyles.push(currentModalStyleId);
                sessionStorage.setItem('selectedStyles', JSON.stringify(selectedStyles));
            }
            
            // Redirect to story builder
            window.location.href = `/story-builder.html?addStyle=${currentModalStyleId}`;
        }
        
        // Flag style for review (admin only)
        async function flagStyleForReview() {
            if (!isSuperAdmin() || !currentModalStyleId) return;
            
            const reason = prompt('Enter reason for flagging this style:');
            if (!reason) return;
            
            const { supabase } = window.SocietyArts;
            
            try {
                // Update style status
                const { error } = await supabase
                    .from('styles')
                    .update({ 
                        status: 'flagged',
                        admin_notes: reason
                    })
                    .eq('id', currentModalStyleId);
                
                if (error) throw error;
                
                showToast('Style flagged for review');
                styleModal.classList.remove('active');
            } catch (error) {
                console.error('Failed to flag style:', error);
                showToast('Failed to flag style');
            }
        }
        
        // Unlist style (admin only)
        async function unlistStyle() {
            if (!isSuperAdmin() || !currentModalStyleId) return;
            
            if (!confirm(`Are you sure you want to unlist style "${currentModalStyleName}"? It will no longer appear in search results.`)) {
                return;
            }
            
            const { supabase } = window.SocietyArts;
            
            try {
                const { error } = await supabase
                    .from('styles')
                    .update({ status: 'unlisted' })
                    .eq('id', currentModalStyleId);
                
                if (error) throw error;
                
                showToast('Style unlisted');
                styleModal.classList.remove('active');
                
                // Remove from grid
                const card = document.querySelector(`[data-style-id="${currentModalStyleId}"]`);
                if (card) card.remove();
                
                // Update results count
                updateResultsCount();
            } catch (error) {
                console.error('Failed to unlist style:', error);
                showToast('Failed to unlist style');
            }
        }
        
        // ============================================
        // Inline Edit Functions (Admin)
        // ============================================
        function toggleEditTitle() {
            const nameEl = document.getElementById('styleModalName');
            const inputEl = document.getElementById('styleModalNameInput');
            
            if (inputEl.style.display === 'none') {
                nameEl.style.display = 'none';
                inputEl.style.display = 'block';
                inputEl.focus();
                inputEl.select();
            } else {
                saveTitle();
            }
        }
        
        function handleTitleKeydown(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                saveTitle();
            } else if (event.key === 'Escape') {
                // Cancel edit
                document.getElementById('styleModalName').style.display = 'block';
                document.getElementById('styleModalNameInput').style.display = 'none';
            }
        }
        
        async function saveTitle() {
            const nameEl = document.getElementById('styleModalName');
            const inputEl = document.getElementById('styleModalNameInput');
            const newName = inputEl.value.trim();
            
            if (!newName || newName === currentModalStyleName) {
                nameEl.style.display = 'block';
                inputEl.style.display = 'none';
                return;
            }
            
            const { supabase } = window.SocietyArts;
            
            try {
                const { error } = await supabase
                    .from('styles')
                    .update({ name: newName })
                    .eq('id', currentModalStyleId);
                
                if (error) throw error;
                
                nameEl.textContent = newName;
                currentModalStyleName = newName;
                showToast('Title updated');
                
                // Update card in grid
                const card = document.querySelector(`[data-style-id="${currentModalStyleId}"] .style-card-name`);
                if (card) card.textContent = newName;
            } catch (error) {
                console.error('Failed to update title:', error);
                showToast('Failed to update title');
            }
            
            nameEl.style.display = 'block';
            inputEl.style.display = 'none';
        }
        
        function toggleEditDescription() {
            const descRow = document.getElementById('styleModalDescription').parentElement;
            const inputEl = document.getElementById('styleModalDescInput');
            
            if (inputEl.style.display === 'none') {
                descRow.style.display = 'none';
                inputEl.style.display = 'block';
                inputEl.focus();
            } else {
                saveDescription();
            }
        }
        
        async function saveDescription() {
            const descEl = document.getElementById('styleModalDescription');
            const descRow = descEl.parentElement;
            const inputEl = document.getElementById('styleModalDescInput');
            const newDesc = inputEl.value.trim();
            
            const originalDesc = currentModalStyle?.description || '';
            
            if (newDesc === originalDesc) {
                descRow.style.display = 'flex';
                inputEl.style.display = 'none';
                return;
            }
            
            const { supabase } = window.SocietyArts;
            
            try {
                const { error } = await supabase
                    .from('styles')
                    .update({ description: newDesc || null })
                    .eq('id', currentModalStyleId);
                
                if (error) throw error;
                
                descEl.textContent = newDesc || 'No description available.';
                currentModalStyle.description = newDesc;
                showToast('Description updated');
            } catch (error) {
                console.error('Failed to update description:', error);
                showToast('Failed to update description');
            }
            
            descRow.style.display = 'flex';
            inputEl.style.display = 'none';
        }
        
        function openTagsEditor() {
            // Open the full edit modal for tag management
            openEditStyleModal(currentModalStyleId);
        }
        
        styleModalClose.addEventListener('click', () => styleModal.classList.remove('active'));
        styleModal.addEventListener('click', (e) => {
            if (e.target === styleModal) styleModal.classList.remove('active');
        });
        
        // ============================================
        // Lightbox
        // ============================================
        function openLightbox(index) {
            lightboxIndex = index;
            updateLightbox();
            lightbox.classList.add('active');
        }
        
        function updateLightbox() {
            lightboxImage.src = lightboxImages[lightboxIndex];
            lightboxCounter.textContent = `${lightboxIndex + 1} / ${lightboxImages.length}`;
            lightboxImage.classList.remove('zoomed');
            isZoomed = false;
        }
        
        document.getElementById('lightboxClose').addEventListener('click', () => {
            lightbox.classList.remove('active');
        });
        
        document.getElementById('lightboxPrev').addEventListener('click', (e) => {
            e.stopPropagation();
            lightboxIndex = (lightboxIndex - 1 + lightboxImages.length) % lightboxImages.length;
            updateLightbox();
        });
        
        document.getElementById('lightboxNext').addEventListener('click', (e) => {
            e.stopPropagation();
            lightboxIndex = (lightboxIndex + 1) % lightboxImages.length;
            updateLightbox();
        });
        
        lightboxImage.addEventListener('click', (e) => {
            e.stopPropagation();
            isZoomed = !isZoomed;
            lightboxImage.classList.toggle('zoomed', isZoomed);
            if (isZoomed) {
                lightboxImage.style.width = '150%';
                lightboxImage.style.maxWidth = 'none';
            } else {
                lightboxImage.style.width = '';
                lightboxImage.style.maxWidth = '';
            }
        });
        
        lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox) {
                lightbox.classList.remove('active');
            }
        });
        
        // ============================================
        // Context Menu
        // ============================================
        const contextMenuHeader = document.getElementById('contextMenuHeader');
        
        function openContextMenu(event, styleId, imageUrl) {
            event.preventDefault();
            currentMenuStyleId = styleId;
            currentMenuImageUrl = imageUrl;
            
            // Get style name from cached data (synchronous)
            const style = SocietyArts.getStyleFromCache(styleId);
            contextMenuHeader.textContent = style ? style.name : 'Style Options';
            
            const x = Math.min(event.clientX, window.innerWidth - 220);
            const y = Math.min(event.clientY, window.innerHeight - 200);
            
            contextMenu.style.left = x + 'px';
            contextMenu.style.top = y + 'px';
            contextMenu.classList.add('active');
        }
        
        document.addEventListener('click', () => {
            contextMenu.classList.remove('active');
        });
        
        document.getElementById('menuSave').addEventListener('click', async () => {
            if (!currentMenuStyleId) return;
            SocietyArts.saveStyle(currentMenuStyleId);
            showToast('Style saved to your collection!');
        });
        
        document.getElementById('menuAddToCollection').addEventListener('click', () => {
            if (!currentMenuStyleId) return;
            openCollectionModal();
        });
        
        document.getElementById('menuReportSwap').addEventListener('click', async () => {
            if (!currentMenuStyleId) return;
            const result = await SocietyArts.reportStyleForReview(currentMenuStyleId);
            showToast(result.message, 5000);
        });
        
        // Unlist style - show confirmation first
        let styleToUnlist = null;
        
        document.getElementById('menuReportDelete').addEventListener('click', () => {
            if (!currentMenuStyleId) return;
            styleToUnlist = currentMenuStyleId;
            confirmModal.classList.add('active');
        });
        
        document.getElementById('confirmCancel').addEventListener('click', () => {
            styleToUnlist = null;
            confirmModal.classList.remove('active');
        });
        
        document.getElementById('confirmUnlist').addEventListener('click', async () => {
            if (!styleToUnlist) return;
            
            confirmModal.classList.remove('active');
            showLoading(true);
            
            const result = await SocietyArts.unlistStyle(styleToUnlist);
            
            if (result.success) {
                renderStyles();
                updateResultsCount();
                updatePagination();
            }
            
            showLoading(false);
            showToast(result.message, 4000);
            styleToUnlist = null;
        });
        
        confirmModal.addEventListener('click', (e) => {
            if (e.target === confirmModal) {
                styleToUnlist = null;
                confirmModal.classList.remove('active');
            }
        });
        
        // ============================================
        // Collection Modal
        // ============================================
        function openCollectionModal() {
            renderCollectionList();
            collectionModal.classList.add('active');
        }
        
        function renderCollectionList() {
            const collections = SocietyArts.getCollections();
            const styleCollections = SocietyArts.getStyleCollections(currentMenuStyleId);
            const styleCollectionIds = styleCollections.map(c => c.id);
            
            if (collections.length === 0) {
                document.getElementById('collectionList').innerHTML = 
                    '<p style="color:#999;text-align:center;padding:1rem;">No collections yet. Create one below!</p>';
                return;
            }
            
            document.getElementById('collectionList').innerHTML = collections.map(col => `
                <div class="collection-item ${styleCollectionIds.includes(col.id) ? 'selected' : ''}" 
                     onclick="toggleCollection('${col.id}')">
                    <div class="collection-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7"></rect>
                            <rect x="14" y="3" width="7" height="7"></rect>
                            <rect x="14" y="14" width="7" height="7"></rect>
                            <rect x="3" y="14" width="7" height="7"></rect>
                        </svg>
                    </div>
                    <div class="collection-item-info">
                        <div class="collection-item-name">${col.name}</div>
                        <div class="collection-item-count">${col.styleIds.length} style${col.styleIds.length !== 1 ? 's' : ''}</div>
                    </div>
                </div>
            `).join('');
        }
        
        function toggleCollection(collectionId) {
            const collections = SocietyArts.getStyleCollections(currentMenuStyleId);
            const isInCollection = collections.some(c => c.id === collectionId);
            
            if (isInCollection) {
                SocietyArts.removeFromCollection(collectionId, currentMenuStyleId);
                showToast('Removed from collection');
            } else {
                SocietyArts.addToCollection(collectionId, currentMenuStyleId);
                showToast('Added to collection');
            }
            
            renderCollectionList();
        }
        
        document.getElementById('collectionModalClose').addEventListener('click', () => {
            collectionModal.classList.remove('active');
        });
        
        collectionModal.addEventListener('click', (e) => {
            if (e.target === collectionModal) collectionModal.classList.remove('active');
        });
        
        document.getElementById('createCollectionBtn').addEventListener('click', () => {
            const input = document.getElementById('newCollectionName');
            const name = input.value.trim();
            
            if (!name) {
                showToast('Please enter a collection name');
                return;
            }
            
            SocietyArts.createCollection(name);
            input.value = '';
            renderCollectionList();
            showToast(`Collection "${name}" created`);
        });
        
        document.getElementById('newCollectionName').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('createCollectionBtn').click();
            }
        });
        
        // ============================================
        // Keyboard Navigation
        // ============================================
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (confirmModal.classList.contains('active')) {
                    styleToUnlist = null;
                    confirmModal.classList.remove('active');
                } else if (lightbox.classList.contains('active')) {
                    lightbox.classList.remove('active');
                } else if (collectionModal.classList.contains('active')) {
                    collectionModal.classList.remove('active');
                } else if (styleModal.classList.contains('active')) {
                    styleModal.classList.remove('active');
                }
                contextMenu.classList.remove('active');
            }
            
            if (lightbox.classList.contains('active')) {
                if (e.key === 'ArrowLeft') {
                    document.getElementById('lightboxPrev').click();
                } else if (e.key === 'ArrowRight') {
                    document.getElementById('lightboxNext').click();
                }
            }
        });
        
        // ============================================
        // AUTHENTICATION SYSTEM
        // ============================================
        
        // Auth State
        let currentUser = null;
        let userProfile = null;
        let currentEditStyleId = null;
        
        // Initialize Auth using shared auth.js
        async function initializeAuthLocal() {
            // Use shared auth initialization
            await window.initializeAuth();
            
            // Sync local variables with shared state
            currentUser = window.AuthState?.user;
            userProfile = window.AuthState?.profile;
            
            // Load favorites if logged in
            if (currentUser) {
                await loadUserFavoritesLocal();
            }
            
            // Listen for auth changes via shared system
            window.addAuthListener(async (state) => {
                const wasLoggedIn = !!currentUser;
                currentUser = state.user;
                userProfile = state.profile;
                
                if (state.user && !wasLoggedIn) {
                    // Just signed in
                    await loadUserFavoritesLocal();
                    renderStyles();
                    showToast('Signed in successfully!');
                } else if (!state.user && wasLoggedIn) {
                    // Just signed out
                    localFavorites = [];
                    renderStyles();
                    showToast('Signed out');
                }
            });
        }
        
        // Load user profile from database
        async function loadUserProfile() {
            if (!currentUser) return;
            
            const { supabase } = window.SocietyArts;
            
            const { data, error } = await supabase
                .from('user_profiles')
                .select('*')
                .eq('id', currentUser.id)
                .single();
            
            if (error) {
                console.error('Error loading profile:', error);
                // Profile might not exist yet - create it
                if (error.code === 'PGRST116') {
                    await createUserProfile();
                }
                return;
            }
            
            userProfile = data;
            
            // Also update shared AuthState for consistency
            if (window.SocietyArts?.AuthState) {
                window.SocietyArts.AuthState.profile = data;
            }
            
            console.log('Loaded user profile:', userProfile);
        }
        
        // Create user profile if it doesn't exist
        async function createUserProfile() {
            if (!currentUser) return;
            
            const { supabase } = window.SocietyArts;
            
            const displayName = currentUser.user_metadata?.full_name || 
                               currentUser.user_metadata?.name || 
                               currentUser.email.split('@')[0];
            
            const { data, error } = await supabase
                .from('user_profiles')
                .insert({
                    id: currentUser.id,
                    email: currentUser.email,
                    display_name: displayName,
                    role: currentUser.email === 'steve@societyarts.com' ? 'super_admin' : 'user'
                })
                .select()
                .single();
            
            if (error) {
                console.error('Error creating profile:', error);
                return;
            }
            
            userProfile = data;
        }
        
        // The header UI is now managed by /js/shared/header.js
        // No need for updateAuthUI here
        
        function getInitials(name) {
            if (!name) return 'U';
            const parts = name.trim().split(/\s+/);
            if (parts.length >= 2) {
                return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase();
            }
            return name.substring(0, 2).toUpperCase();
        }
        
        // Check if current user is admin
        function isAdmin() {
            return userProfile && (userProfile.role === 'admin' || userProfile.role === 'super_admin');
        }
        
        function isSuperAdmin() {
            return userProfile && userProfile.role === 'super_admin';
        }
        
        // ============================================
        // AUTH MODAL FUNCTIONS (Handled by shared auth.js)
        // ============================================
        
        // openAuthModal, closeAuthModal, showAuthView are now provided by /js/shared/auth.js
        // The auth modal is dynamically injected by the shared auth system
        
        function showUnderConstruction(provider) {
            showToast(`${provider} login coming soon! Please use Google or email sign-in.`);
        }
        
        // Toggle password visibility (for profile edit)
        function togglePasswordVisibility(inputId) {
            const input = document.getElementById(inputId);
            if (input) {
                input.type = input.type === 'password' ? 'text' : 'password';
            }
        }
        
        // ============================================
        // AUTH HANDLERS (Using shared auth.js)
        // ============================================
        
        // signInWithGoogle is now provided by shared auth.js (window.signInWithGoogle)
        // The shared auth modal handles all form submissions
        
        // Logout handler - use shared signOut
        async function handleLogout() {
            try {
                await window.signOut();
            } catch (error) {
                console.error('Logout error:', error);
            }
            closeUserMenu();
        }
        
        // Legacy form handlers - redirect to shared auth modal
        function handleEmailSubmit(event) {
            event?.preventDefault();
            openAuthModal();
        }
        
        function handleSignIn(event) {
            event?.preventDefault();
            openAuthModal();
        }
        
        function handleSignUp(event) {
            event?.preventDefault();
            openAuthModal();
        }
        
        function handleForgotPassword(event) {
            event?.preventDefault();
            openAuthModal();
        }
        
        // ============================================
        // USER MENU FUNCTIONS
        // ============================================
        // USER MENU - Now handled by header.js
        // ============================================
        
        function toggleUserMenu() {
            // Use the unified header system
            if (window.SocietyArts?.toggleUserMenu) {
                window.SocietyArts.toggleUserMenu();
            }
        }
        
        function closeUserMenu() {
            // Use the unified header system
            if (window.SocietyArts?.closeUserMenu) {
                window.SocietyArts.closeUserMenu();
            }
        }
        
        // Close user menu on outside click is now handled by header.js
        
        // ============================================
        // PROFILE MODAL FUNCTIONS
        // ============================================
        
        function openProfileModal() {
            closeUserMenu();
            
            if (!currentUser || !userProfile) return;
            
            // Populate profile data
            const initials = getInitials(userProfile.display_name);
            document.getElementById('profileInitials').textContent = initials;
            document.getElementById('profileName').textContent = userProfile.display_name || 'User';
            document.getElementById('profileEmail').textContent = currentUser.email;
            document.getElementById('profileDisplayName').textContent = userProfile.display_name || 'Not set';
            document.getElementById('profileEmailField').textContent = currentUser.email;
            
            // Handle avatar
            const avatarEl = document.getElementById('profileAvatar');
            if (userProfile.avatar_url) {
                avatarEl.innerHTML = `<img src="${userProfile.avatar_url}" alt="Avatar">`;
            } else {
                avatarEl.innerHTML = `<span id="profileInitials">${initials}</span>`;
            }
            
            // Show role badge and admin section if applicable
            const roleBadge = document.getElementById('profileRole');
            const adminSection = document.getElementById('profileAdminSection');
            
            if (userProfile.role === 'admin' || userProfile.role === 'super_admin') {
                roleBadge.textContent = userProfile.role === 'super_admin' ? 'Super Admin' : 'Admin';
                roleBadge.style.display = 'inline-block';
                adminSection.style.display = 'block';
                document.getElementById('profileRoleText').textContent = 
                    userProfile.role === 'super_admin' ? 'Super Admin' : 'Admin';
            } else {
                roleBadge.style.display = 'none';
                adminSection.style.display = 'none';
            }
            
            document.getElementById('profileModalOverlay').classList.add('open');
        }
        
        function closeProfileModal() {
            document.getElementById('profileModalOverlay').classList.remove('open');
        }
        
        async function editProfileField(field) {
            const newValue = prompt(`Enter new ${field === 'displayName' ? 'display name' : field}:`);
            
            if (!newValue || !newValue.trim()) return;
            
            const { supabase } = window.SocietyArts;
            
            if (field === 'displayName') {
                const { error } = await supabase
                    .from('user_profiles')
                    .update({ display_name: newValue.trim(), updated_at: new Date().toISOString() })
                    .eq('id', currentUser.id);
                
                if (error) {
                    showToast('Failed to update display name');
                    return;
                }
                
                userProfile.display_name = newValue.trim();
                // Update the shared auth state to refresh header
                if (window.AuthState) {
                    window.AuthState.profile = userProfile;
                    window.SocietyArts?.updateHeaderAuth?.();
                }
                openProfileModal(); // Refresh
                showToast('Display name updated!');
            } else if (field === 'password') {
                const { error } = await supabase.auth.updateUser({
                    password: newValue
                });
                
                if (error) {
                    showToast('Failed to update password: ' + error.message);
                    return;
                }
                
                showToast('Password updated!');
            }
        }
        
        async function handleAvatarUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // Validate file type
            if (!file.type.startsWith('image/')) {
                showToast('Please select an image file');
                return;
            }
            
            // Validate file size (max 2MB)
            if (file.size > 2 * 1024 * 1024) {
                showToast('Image must be less than 2MB');
                return;
            }
            
            const { supabase } = window.SocietyArts;
            
            // Upload to storage
            const fileExt = file.name.split('.').pop();
            const filePath = `${currentUser.id}/avatar.${fileExt}`;
            
            const { data: uploadData, error: uploadError } = await supabase.storage
                .from('avatars')
                .upload(filePath, file, { upsert: true });
            
            if (uploadError) {
                console.error('Upload error:', uploadError);
                showToast('Failed to upload avatar');
                return;
            }
            
            // Get public URL
            const { data: urlData } = supabase.storage
                .from('avatars')
                .getPublicUrl(filePath);
            
            // Update profile
            const { error: updateError } = await supabase
                .from('user_profiles')
                .update({ avatar_url: urlData.publicUrl, updated_at: new Date().toISOString() })
                .eq('id', currentUser.id);
            
            if (updateError) {
                console.error('Update error:', updateError);
                showToast('Failed to update profile');
                return;
            }
            
            userProfile.avatar_url = urlData.publicUrl;
            // Update the shared auth state to refresh header
            if (window.AuthState) {
                window.AuthState.profile = userProfile;
                window.SocietyArts?.updateHeaderAuth?.();
            }
            openProfileModal(); // Refresh
            showToast('Avatar updated!');
        }
        
        // ============================================
        // ADMIN USER MANAGEMENT
        // ============================================
        
        async function openAdminUsersModal() {
            closeUserMenu();
            
            if (!isSuperAdmin()) {
                showToast('Only super admins can manage users');
                return;
            }
            
            // TODO: Implement admin users modal
            showToast('User management coming soon!');
        }
        
        // ============================================
        // EDIT STYLE MODAL (Admin Only)
        // ============================================
        
        async function openEditStyleModal(styleId) {
            if (!isAdmin()) {
                showToast('Only admins can edit styles');
                return;
            }
            
            currentEditStyleId = styleId;
            
            // Get style data
            const style = SocietyArts.getStyleById(styleId);
            if (!style) {
                showToast('Style not found');
                return;
            }
            
            // Populate form
            document.getElementById('editStyleThumbnail').querySelector('img').src = style.thumbnail;
            document.getElementById('editStyleId').textContent = style.id;
            document.getElementById('editStyleName').value = style.name || '';
            document.getElementById('editStyleTagline').value = style.tagline || '';
            document.getElementById('editStyleDescription').value = style.description || '';
            
            // Populate dropdowns
            await populateEditStyleDropdowns();
            
            // Set current values (would need to load from junction tables)
            document.getElementById('editStyleComplexity').value = style.complexity || '';
            
            // Set checkboxes
            const featuredCheckbox = document.getElementById('editStyleFeaturedCheckbox');
            const newCheckbox = document.getElementById('editStyleNewCheckbox');
            
            featuredCheckbox.classList.toggle('checked', style.is_featured);
            newCheckbox.classList.toggle('checked', style.is_new);
            
            // Add click handlers for checkboxes
            featuredCheckbox.onclick = () => featuredCheckbox.classList.toggle('checked');
            newCheckbox.onclick = () => newCheckbox.classList.toggle('checked');
            
            document.getElementById('editStyleModalOverlay').classList.add('open');
        }
        
        function closeEditStyleModal() {
            document.getElementById('editStyleModalOverlay').classList.remove('open');
            currentEditStyleId = null;
        }
        
        async function populateEditStyleDropdowns() {
            const lookups = SocietyArts.getLookups();
            
            const dropdownMap = {
                'editStyleArtType': 'art_types',
                'editStyleMedium': 'mediums',
                'editStyleEra': 'eras',
                'editStyleCulture': 'cultures',
                'editStylePalette': 'palettes',
                'editStyleLighting': 'lighting',
                'editStyleComposition': 'compositions'
            };
            
            Object.entries(dropdownMap).forEach(([selectId, lookupTable]) => {
                const select = document.getElementById(selectId);
                const options = lookups[lookupTable] || [];
                
                // Keep first option
                select.innerHTML = select.options[0].outerHTML;
                
                options.forEach(opt => {
                    const option = document.createElement('option');
                    option.value = opt.id;
                    option.textContent = opt.name;
                    select.appendChild(option);
                });
            });
        }
        
        async function handleSaveStyle(event) {
            event.preventDefault();
            
            if (!currentEditStyleId || !isAdmin()) return;
            
            const { supabase } = window.SocietyArts;
            
            const updates = {
                name: document.getElementById('editStyleName').value.trim(),
                tagline: document.getElementById('editStyleTagline').value.trim(),
                description: document.getElementById('editStyleDescription').value.trim(),
                complexity: parseInt(document.getElementById('editStyleComplexity').value) || null,
                is_featured: document.getElementById('editStyleFeaturedCheckbox').classList.contains('checked'),
                is_new: document.getElementById('editStyleNewCheckbox').classList.contains('checked'),
                updated_at: new Date().toISOString()
            };
            
            const btn = document.getElementById('saveStyleBtn');
            btn.disabled = true;
            btn.textContent = 'Saving...';
            
            const { error } = await supabase
                .from('styles')
                .update(updates)
                .eq('id', currentEditStyleId);
            
            btn.disabled = false;
            btn.textContent = 'Save Changes';
            
            if (error) {
                console.error('Save error:', error);
                showToast('Failed to save changes: ' + error.message);
                return;
            }
            
            // TODO: Update junction tables for categories
            
            showToast('Style updated successfully!');
            closeEditStyleModal();
            
            // Refresh the styles
            await SocietyArts.applyFilters({});
            renderStyles();
        }
        
        // Close modals when clicking overlay
        // Note: Auth modal overlay is handled by shared auth.js
        
        document.getElementById('profileModalOverlay').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) closeProfileModal();
        });
        
        document.getElementById('editStyleModalOverlay').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) closeEditStyleModal();
        });
        
        // Close modals with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                // closeAuthModal handled by shared auth.js
                closeProfileModal();
                closeEditStyleModal();
                closeHelpModal();
            }
        });
        
        // ============================================
        // Help Modal - Now handled by header.js
        // ============================================
        function openHelpModal() {
            // Use the unified help modal from header.js
            if (window.openHelp) {
                window.openHelp();
            } else if (window.SocietyArts?.openHelpModal) {
                window.SocietyArts.openHelpModal();
            }
        }
        
        function closeHelpModal() {
            // Use the unified help modal from header.js
            if (window.closeHelpModal) {
                window.closeHelpModal();
            } else if (window.SocietyArts?.closeHelpModal) {
                window.SocietyArts.closeHelpModal();
            }
        }
        
        // ============================================
        // Start
        // ============================================
        // Initialize auth first to get user's favorites, then render styles
        initializeAuth().then(() => {
            initialize();
        });
    </script>
    
    <!-- Help Modal -->
    <div class="help-modal-overlay" id="helpModal" onclick="closeHelpModal()">
        <div class="help-modal" onclick="event.stopPropagation()">
            <div class="help-modal-header">
                <h3>Help & Resources</h3>
                <button class="help-modal-close" onclick="closeHelpModal()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="help-modal-content">
                <a href="under-construction.html?feature=Documentation" class="help-modal-item">
                    <span class="help-modal-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                        </svg>
                    </span>
                    <div class="help-modal-item-text">
                        <span class="help-modal-item-title">Documentation</span>
                        <span class="help-modal-item-desc">Learn how to use Society Arts</span>
                    </div>
                </a>
                <a href="under-construction.html?feature=Video%20Tutorials" class="help-modal-item">
                    <span class="help-modal-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="23 7 16 12 23 17 23 7"></polygon>
                            <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
                        </svg>
                    </span>
                    <div class="help-modal-item-text">
                        <span class="help-modal-item-title">Video Tutorials</span>
                        <span class="help-modal-item-desc">Watch step-by-step guides</span>
                    </div>
                </a>
                <a href="under-construction.html?feature=Community" class="help-modal-item">
                    <span class="help-modal-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
                        </svg>
                    </span>
                    <div class="help-modal-item-text">
                        <span class="help-modal-item-title">Community</span>
                        <span class="help-modal-item-desc">Join discussions with other artists</span>
                    </div>
                </a>
                <a href="mailto:support@societyarts.com" class="help-modal-item">
                    <span class="help-modal-item-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                            <polyline points="22,6 12,13 2,6"></polyline>
                        </svg>
                    </span>
                    <div class="help-modal-item-text">
                        <span class="help-modal-item-title">Contact Support</span>
                        <span class="help-modal-item-desc">Get help from our team</span>
                    </div>
                </a>
            </div>
        </div>
    </div>
</body>
</html>
