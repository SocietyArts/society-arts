<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FAQ - Society Arts</title>
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://pub-acb560f551f141db830964aed1fa005f.r2.dev/site-assets/SA_Monogram_Black%401x%201x1.png">
  
  <!-- React -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Domine:wght@400;500;600;700&family=Familjen+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- CSS -->
  <link rel="stylesheet" href="/css/variables.css">
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/components.css">
  <link rel="stylesheet" href="/css/header.css">
  <link rel="stylesheet" href="/css/auth.css">
  <link rel="stylesheet" href="/css/help-modals.css">
  
  <style>
    /* ========================================
       FAQ PAGE LAYOUT
       ======================================== */
    
    .faq-content {
      flex: 1;
      padding: var(--space-2xl);
      overflow-y: auto;
    }
    
    /* Breadcrumb */
    .faq-breadcrumb {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      font-size: var(--text-sm);
      color: var(--color-text-muted);
      margin-bottom: var(--space-md);
    }
    
    .faq-breadcrumb a {
      color: var(--color-text-muted);
      text-decoration: none;
      transition: color var(--transition-fast);
    }
    
    .faq-breadcrumb a:hover {
      color: var(--color-accent);
    }
    
    /* Page Header */
    .faq-page-header {
      margin-bottom: var(--space-2xl);
      max-width: 800px;
    }
    
    .faq-page-title {
      font-family: var(--font-serif);
      font-size: var(--text-3xl);
      font-weight: var(--weight-medium);
      color: var(--color-text-primary);
      margin: 0 0 var(--space-sm) 0;
    }
    
    .faq-page-subtitle {
      font-size: var(--text-base);
      color: var(--color-text-muted);
      line-height: var(--leading-relaxed);
      margin: 0;
    }
    
    /* ========================================
       FAQ LAYOUT - Two Column
       ======================================== */
    
    .faq-layout {
      display: flex;
      gap: var(--space-2xl);
      max-width: 1200px;
    }
    
    /* Categories Sidebar */
    .faq-categories {
      width: 240px;
      flex-shrink: 0;
    }
    
    .faq-categories-title {
      font-family: var(--font-primary);
      font-size: 12px;
      font-weight: var(--weight-semibold);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--color-text-muted);
      margin: 0 0 var(--space-md) 0;
      padding: 0 var(--space-sm);
    }
    
    .faq-category-list {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    
    .faq-category-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px var(--space-md);
      font-family: var(--font-primary);
      font-size: var(--text-sm);
      font-weight: var(--weight-medium);
      color: var(--color-text-secondary);
      background: none;
      border: none;
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all var(--transition-fast);
      text-align: left;
      width: 100%;
    }
    
    .faq-category-item:hover {
      background: var(--color-surface-hover);
      color: var(--color-text-primary);
    }
    
    .faq-category-item.active {
      background: var(--color-surface);
      color: var(--color-text-primary);
      font-weight: var(--weight-semibold);
    }
    
    .faq-category-name {
      flex: 1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .faq-category-count {
      font-size: var(--text-sm);
      font-weight: var(--weight-regular);
      color: var(--color-text-muted);
      margin-left: var(--space-sm);
    }
    
    .faq-category-item.active .faq-category-count {
      color: var(--color-text-secondary);
    }
    
    /* ========================================
       FAQ MAIN CONTENT
       ======================================== */
    
    .faq-main {
      flex: 1;
      min-width: 0;
    }
    
    /* Search */
    .faq-search-wrapper {
      position: relative;
      margin-bottom: var(--space-xl);
    }
    
    .faq-search-icon {
      position: absolute;
      left: 14px;
      top: 50%;
      transform: translateY(-50%);
      width: 18px;
      height: 18px;
      color: var(--color-text-muted);
      pointer-events: none;
    }
    
    .faq-search-input {
      width: 100%;
      max-width: 400px;
      padding: 12px 44px 12px 44px;
      font-family: var(--font-primary);
      font-size: var(--text-base);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-md);
      background: var(--color-surface);
      color: var(--color-text-primary);
      transition: all var(--transition-normal);
    }
    
    .faq-search-input:focus {
      outline: none;
      border-color: var(--color-tan-40);
      box-shadow: 0 0 0 3px rgba(62, 35, 24, 0.08);
    }
    
    .faq-search-input::placeholder {
      color: var(--color-text-placeholder);
    }
    
    .faq-search-clear {
      position: absolute;
      right: calc(100% - 400px + 10px);
      top: 50%;
      transform: translateY(-50%);
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--color-tan-20);
      border: none;
      border-radius: var(--radius-full);
      cursor: pointer;
      color: var(--color-text-secondary);
      opacity: 0;
      pointer-events: none;
      transition: all var(--transition-fast);
    }
    
    .faq-search-clear.visible {
      opacity: 1;
      pointer-events: auto;
    }
    
    .faq-search-clear:hover {
      background: var(--color-tan-40);
      color: var(--color-text-primary);
    }
    
    .faq-search-results-info {
      font-size: var(--text-sm);
      color: var(--color-text-muted);
      margin-bottom: var(--space-lg);
    }
    
    .faq-search-results-info strong {
      color: var(--color-text-primary);
    }
    
    /* Section Title */
    .faq-section-title {
      font-family: var(--font-primary);
      font-size: 12px;
      font-weight: var(--weight-semibold);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--color-text-muted);
      margin: 0 0 var(--space-md) 0;
    }
    
    /* FAQ Cards */
    .faq-cards {
      display: flex;
      flex-direction: column;
      gap: var(--space-md);
    }
    
    .faq-card {
      background: var(--color-surface);
      border-radius: var(--radius-lg);
      border: 1px solid var(--color-border);
      overflow: hidden;
      transition: all var(--transition-normal);
    }
    
    .faq-card:hover {
      border-color: var(--color-tan-40);
      box-shadow: var(--shadow-card);
    }
    
    .faq-card-header {
      display: flex;
      align-items: flex-start;
      gap: var(--space-md);
      padding: var(--space-lg) var(--space-xl);
      cursor: pointer;
      transition: background var(--transition-fast);
    }
    
    .faq-card-header:hover {
      background: var(--color-surface-alt);
    }
    
    .faq-card-icon {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(62, 35, 24, 0.08);
      border-radius: var(--radius-sm);
      color: var(--color-brown);
      flex-shrink: 0;
      margin-top: 2px;
    }
    
    .faq-card-icon svg {
      width: 18px;
      height: 18px;
    }
    
    .faq-card-content {
      flex: 1;
      min-width: 0;
    }
    
    .faq-card-question {
      font-family: var(--font-primary);
      font-size: var(--text-md);
      font-weight: var(--weight-semibold);
      color: var(--color-text-primary);
      margin: 0 0 6px 0;
      line-height: var(--leading-snug);
    }
    
    .faq-card-preview {
      font-size: var(--text-sm);
      color: var(--color-text-secondary);
      line-height: var(--leading-snug);
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .faq-card-chevron {
      width: 24px;
      height: 24px;
      color: var(--color-text-muted);
      flex-shrink: 0;
      margin-top: 4px;
      transition: transform var(--transition-slow);
    }
    
    .faq-card.open .faq-card-chevron {
      transform: rotate(180deg);
      color: var(--color-brown);
    }
    
    /* FAQ Answer (Expandable) */
    .faq-card-answer {
      display: grid;
      grid-template-rows: 0fr;
      transition: grid-template-rows var(--transition-slow);
    }
    
    .faq-card.open .faq-card-answer {
      grid-template-rows: 1fr;
    }
    
    .faq-card-answer-inner {
      overflow: hidden;
    }
    
    .faq-card-answer-content {
      padding: 0 var(--space-xl) var(--space-lg) 64px;
      font-size: var(--text-base);
      color: var(--color-text-secondary);
      line-height: var(--leading-relaxed);
    }
    
    .faq-card-answer-content p {
      margin: 0 0 12px 0;
    }
    
    .faq-card-answer-content p:last-child {
      margin-bottom: 0;
    }
    
    .faq-card-answer-content strong {
      color: var(--color-text-primary);
      font-weight: var(--weight-semibold);
    }
    
    .faq-card-answer-content ul,
    .faq-card-answer-content ol {
      margin: 12px 0;
      padding-left: 24px;
    }
    
    .faq-card-answer-content li {
      margin-bottom: 8px;
    }
    
    /* Search Highlight */
    .faq-highlight {
      background: rgba(212, 165, 116, 0.3);
      padding: 1px 2px;
      border-radius: 2px;
    }
    
    /* Top Questions Section */
    .faq-top-questions {
      margin-bottom: var(--space-2xl);
    }
    
    /* Category Section */
    .faq-category-section {
      margin-top: var(--space-xl);
    }
    
    /* Empty State */
    .faq-empty {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: var(--space-4xl);
      text-align: center;
    }
    
    .faq-empty-icon {
      width: 64px;
      height: 64px;
      color: var(--color-tan-40);
      margin-bottom: var(--space-lg);
    }
    
    .faq-empty-title {
      font-family: var(--font-serif);
      font-size: var(--text-lg);
      font-weight: var(--weight-medium);
      color: var(--color-text-primary);
      margin: 0 0 var(--space-sm) 0;
    }
    
    .faq-empty-text {
      font-size: var(--text-sm);
      color: var(--color-text-muted);
      margin: 0;
    }
    
    /* Loading State */
    .faq-loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: var(--space-4xl);
    }
    
    .faq-loading-spinner {
      width: 32px;
      height: 32px;
      border: 3px solid var(--color-border);
      border-top-color: var(--color-brown);
      border-radius: var(--radius-full);
      animation: spin 0.8s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .faq-loading-text {
      margin-top: var(--space-md);
      font-size: var(--text-sm);
      color: var(--color-text-muted);
    }
    
    /* ========================================
       Mobile Responsive
       ======================================== */
    
    @media (max-width: 900px) {
      .faq-layout {
        flex-direction: column;
        gap: var(--space-xl);
      }
      
      .faq-categories {
        width: 100%;
      }
      
      .faq-category-list {
        flex-direction: row;
        flex-wrap: wrap;
        gap: var(--space-sm);
      }
      
      .faq-category-item {
        width: auto;
        padding: 8px 14px;
        border-radius: var(--radius-full);
        background: var(--color-surface);
      }
      
      .faq-category-item.active {
        background: var(--color-brown);
        color: var(--color-white);
      }
      
      .faq-category-item.active .faq-category-count {
        color: rgba(255, 255, 255, 0.7);
      }
    }
    
    @media (max-width: 480px) {
      .faq-content {
        padding: var(--space-lg);
      }
      
      .faq-card-header {
        padding: var(--space-md) var(--space-lg);
      }
      
      .faq-card-answer-content {
        padding-left: var(--space-lg);
      }
      
      .faq-card-icon {
        width: 28px;
        height: 28px;
      }
      
      .faq-card-question {
        font-size: var(--text-base);
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="/js/shared/supabase-client.js"></script>
  <script src="/js/shared/api.js"></script>
  <script src="/js/shared/auth.js"></script>
  <script src="/js/shared/header.js"></script>
  
  <!-- FAQ Page -->
  <script type="text/babel">
    const { useState, useEffect, useMemo, useCallback } = React;
    
    // Icons
    const SearchIcon = () => (
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <circle cx="11" cy="11" r="8"></circle>
        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      </svg>
    );
    
    const XIcon = () => (
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    );
    
    const ChevronDownIcon = () => (
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    );
    
    const ChevronRightIcon = () => (
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    );
    
    const DocumentIcon = () => (
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
        <polyline points="14 2 14 8 20 8"></polyline>
        <line x1="16" y1="13" x2="8" y2="13"></line>
        <line x1="16" y1="17" x2="8" y2="17"></line>
      </svg>
    );
    
    const SearchOffIcon = () => (
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5">
        <circle cx="11" cy="11" r="8"></circle>
        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        <line x1="8" y1="8" x2="14" y2="14"></line>
        <line x1="14" y1="8" x2="8" y2="14"></line>
      </svg>
    );
    
    const StarIcon = () => (
      <svg viewBox="0 0 24 24" fill="currentColor" stroke="none">
        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
      </svg>
    );
    
    // Strip HTML for preview
    function stripHtml(html) {
      const tmp = document.createElement('div');
      tmp.innerHTML = html;
      return tmp.textContent || tmp.innerText || '';
    }
    
    // Highlight text for search
    function highlightText(text, query) {
      if (!query || query.length < 2) return text;
      const regex = new RegExp(`(${query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
      const parts = text.split(regex);
      return parts.map((part, i) => 
        regex.test(part) ? <span key={i} className="faq-highlight">{part}</span> : part
      );
    }
    
    // FAQ Card Component
    function FAQCard({ faq, searchQuery, isOpen, onToggle, isTopQuestion }) {
      const answerPreview = stripHtml(faq.answer).slice(0, 150) + (stripHtml(faq.answer).length > 150 ? '...' : '');
      
      return (
        <div className={`faq-card ${isOpen ? 'open' : ''}`}>
          <div className="faq-card-header" onClick={onToggle}>
            <div className="faq-card-icon">
              {isTopQuestion ? <StarIcon /> : <DocumentIcon />}
            </div>
            <div className="faq-card-content">
              <h3 className="faq-card-question">
                {highlightText(faq.question, searchQuery)}
              </h3>
              {!isOpen && (
                <p className="faq-card-preview">
                  {highlightText(answerPreview, searchQuery)}
                </p>
              )}
            </div>
            <div className="faq-card-chevron">
              <ChevronDownIcon />
            </div>
          </div>
          <div className="faq-card-answer">
            <div className="faq-card-answer-inner">
              <div 
                className="faq-card-answer-content"
                dangerouslySetInnerHTML={{ 
                  __html: searchQuery && searchQuery.length >= 2
                    ? faq.answer.replace(
                        new RegExp(`(${searchQuery.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi'),
                        '<span class="faq-highlight">$1</span>'
                      )
                    : faq.answer 
                }}
              />
            </div>
          </div>
        </div>
      );
    }
    
    // Main FAQ Page
    function FAQPage() {
      const { Header, Sidebar } = window.SocietyArts || {};
      const supabase = window.SocietyArts?.supabase;
      
      if (!Sidebar || !Header) {
        return React.createElement('div', { className: 'loading-state' }, 'Loading...');
      }
      
      const { user, profile, isLoading: authLoading } = window.SocietyArts.useAuth();
      
      const [categories, setCategories] = useState([]);
      const [faqs, setFaqs] = useState([]);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState(null);
      const [selectedCategory, setSelectedCategory] = useState(null);
      const [searchQuery, setSearchQuery] = useState('');
      const [openItems, setOpenItems] = useState(new Set());
      
      // Fetch FAQ data
      useEffect(() => {
        async function fetchFAQs() {
          if (!supabase) {
            console.error('FAQ: No supabase client');
            setError('Database connection not available');
            setLoading(false);
            return;
          }
          
          try {
            console.log('FAQ: Fetching categories...');
            const { data: categoriesData, error: categoriesError } = await supabase
              .from('faq_categories')
              .select('*')
              .order('sort_order');
            
            console.log('FAQ: Categories result:', categoriesData, categoriesError);
            
            if (categoriesError) throw categoriesError;
            
            // Filter active categories client-side if is_active column exists
            const activeCategories = categoriesData?.filter(c => c.is_active !== false) || [];
            
            console.log('FAQ: Fetching FAQs...');
            const { data: faqsData, error: faqsError } = await supabase
              .from('faq')
              .select('*')
              .eq('is_published', true)
              .order('priority');
            
            console.log('FAQ: FAQs result:', faqsData?.length, 'items', faqsError);
            
            if (faqsError) throw faqsError;
            
            setCategories(activeCategories);
            setFaqs(faqsData || []);
            
            // Select first category by default
            if (activeCategories.length > 0) {
              setSelectedCategory(activeCategories[0].id);
            }
          } catch (err) {
            console.error('FAQ: Error fetching data:', err);
            setError(err.message);
          } finally {
            setLoading(false);
          }
        }
        
        fetchFAQs();
      }, [supabase]);
      
      // Get top questions (global_priority not null)
      const topQuestions = useMemo(() => {
        return faqs
          .filter(f => f.global_priority !== null && f.global_priority !== undefined)
          .sort((a, b) => a.global_priority - b.global_priority);
      }, [faqs]);
      
      // Filter FAQs by selected category or search
      const filteredFaqs = useMemo(() => {
        if (searchQuery.length >= 2) {
          const query = searchQuery.toLowerCase();
          return faqs.filter(faq => 
            faq.question.toLowerCase().includes(query) ||
            stripHtml(faq.answer).toLowerCase().includes(query) ||
            (faq.keywords && faq.keywords.toLowerCase().includes(query))
          );
        }
        
        if (selectedCategory) {
          return faqs.filter(faq => faq.category_id === selectedCategory);
        }
        
        return [];
      }, [faqs, selectedCategory, searchQuery]);
      
      // Get FAQ count per category
      const categoryCounts = useMemo(() => {
        const counts = {};
        faqs.forEach(faq => {
          counts[faq.category_id] = (counts[faq.category_id] || 0) + 1;
        });
        return counts;
      }, [faqs]);
      
      // Toggle FAQ open/closed
      const toggleItem = useCallback((id) => {
        setOpenItems(prev => {
          const next = new Set(prev);
          if (next.has(id)) {
            next.delete(id);
          } else {
            next.add(id);
          }
          return next;
        });
      }, []);
      
      // Clear search
      const clearSearch = useCallback(() => {
        setSearchQuery('');
      }, []);
      
      // Get selected category name
      const selectedCategoryName = useMemo(() => {
        const cat = categories.find(c => c.id === selectedCategory);
        return cat ? cat.name : '';
      }, [categories, selectedCategory]);
      
      // Check if we should show top questions (first category selected, no search)
      const showTopQuestions = searchQuery.length < 2 && 
        selectedCategory === categories[0]?.id && 
        topQuestions.length > 0;
      
      return (
        <div className="page-container">
          <Sidebar />
          <Header user={user} profile={profile} />
          
          <main className="faq-content">
            {/* Breadcrumb */}
            <div className="faq-breadcrumb">
              <a href="index.html">Home</a>
              <ChevronRightIcon />
              <span>Frequently Asked Questions</span>
            </div>
            
            {/* Page Header */}
            <div className="faq-page-header">
              <h1 className="faq-page-title">Frequently Asked Questions</h1>
              <p className="faq-page-subtitle">
                Find answers to common questions about Society Arts. Browse by category 
                or search for specific topics to get the help you need.
              </p>
            </div>
            
            {loading ? (
              <div className="faq-loading">
                <div className="faq-loading-spinner"></div>
                <p className="faq-loading-text">Loading FAQs...</p>
              </div>
            ) : error ? (
              <div className="faq-empty">
                <div className="faq-empty-icon"><SearchOffIcon /></div>
                <h3 className="faq-empty-title">Unable to load FAQs</h3>
                <p className="faq-empty-text">{error}</p>
              </div>
            ) : (
              <div className="faq-layout">
                {/* Categories Sidebar */}
                <aside className="faq-categories">
                  <h2 className="faq-categories-title">Categories</h2>
                  <nav className="faq-category-list">
                    {categories.map(category => (
                      <button
                        key={category.id}
                        className={`faq-category-item ${selectedCategory === category.id && searchQuery.length < 2 ? 'active' : ''}`}
                        onClick={() => {
                          setSelectedCategory(category.id);
                          setSearchQuery('');
                          setOpenItems(new Set());
                        }}
                      >
                        <span className="faq-category-name">{category.name}</span>
                        <span className="faq-category-count">{categoryCounts[category.id] || 0}</span>
                      </button>
                    ))}
                  </nav>
                </aside>
                
                {/* Main Content */}
                <div className="faq-main">
                  {/* Search */}
                  <div className="faq-search-wrapper">
                    <span className="faq-search-icon"><SearchIcon /></span>
                    <input
                      type="text"
                      className="faq-search-input"
                      placeholder="Search all questions..."
                      value={searchQuery}
                      onChange={(e) => setSearchQuery(e.target.value)}
                    />
                    <button 
                      className={`faq-search-clear ${searchQuery.length > 0 ? 'visible' : ''}`}
                      onClick={clearSearch}
                      style={{ right: '10px', left: 'auto' }}
                    >
                      <XIcon />
                    </button>
                  </div>
                  
                  {/* Search Results Info */}
                  {searchQuery.length >= 2 && (
                    <p className="faq-search-results-info">
                      Found <strong>{filteredFaqs.length}</strong> result{filteredFaqs.length !== 1 ? 's' : ''} for "<strong>{searchQuery}</strong>"
                    </p>
                  )}
                  
                  {/* Top Questions */}
                  {showTopQuestions && (
                    <div className="faq-top-questions">
                      <h2 className="faq-section-title">Top Questions</h2>
                      <div className="faq-cards">
                        {topQuestions.map(faq => (
                          <FAQCard
                            key={faq.id}
                            faq={faq}
                            searchQuery={searchQuery}
                            isOpen={openItems.has(faq.id)}
                            onToggle={() => toggleItem(faq.id)}
                            isTopQuestion={true}
                          />
                        ))}
                      </div>
                    </div>
                  )}
                  
                  {/* Category Questions */}
                  {searchQuery.length < 2 && selectedCategoryName && (
                    <div className="faq-category-section">
                      <h2 className="faq-section-title">{selectedCategoryName}</h2>
                    </div>
                  )}
                  
                  {/* FAQ Cards */}
                  {filteredFaqs.length > 0 ? (
                    <div className="faq-cards">
                      {filteredFaqs.map(faq => (
                        <FAQCard
                          key={faq.id}
                          faq={faq}
                          searchQuery={searchQuery}
                          isOpen={openItems.has(faq.id)}
                          onToggle={() => toggleItem(faq.id)}
                          isTopQuestion={false}
                        />
                      ))}
                    </div>
                  ) : searchQuery.length >= 2 ? (
                    <div className="faq-empty">
                      <div className="faq-empty-icon"><SearchOffIcon /></div>
                      <h3 className="faq-empty-title">No results found</h3>
                      <p className="faq-empty-text">Try different keywords or browse by category</p>
                    </div>
                  ) : null}
                </div>
              </div>
            )}
          </main>
        </div>
      );
    }
    
    // Wait for components then render
    function waitForComponents() {
      if (window.SocietyArts?.Header && window.SocietyArts?.Sidebar && window.SocietyArts?.useAuth) {
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FAQPage />);
      } else {
        setTimeout(waitForComponents, 50);
      }
    }
    
    waitForComponents();
  </script>
</body>
</html>
